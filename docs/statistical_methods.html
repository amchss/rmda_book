<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Research Methodologies &amp; Data Analysis Using R - 6&nbsp; Statistical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./intro_r.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistical Methods</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Research Methodologies &amp; Data Analysis Using R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About Book</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research_methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Research</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study_design.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Epidemiological Study Designs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validity_reliability_research.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Quality Issues in Research</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./digital_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Digital Data Collection using ODK</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_r.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to R and RStudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical_methods.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistical Methods</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-biostatistics-and-types-of-variables" id="toc-introduction-to-biostatistics-and-types-of-variables" class="nav-link active" data-scroll-target="#introduction-to-biostatistics-and-types-of-variables"><span class="toc-section-number">6.1</span>  Introduction to Biostatistics and Types of Variables</a>
  <ul class="collapse">
  <li><a href="#biostatistics" id="toc-biostatistics" class="nav-link" data-scroll-target="#biostatistics"><span class="toc-section-number">6.1.1</span>  Biostatistics</a></li>
  <li><a href="#types-of-variables" id="toc-types-of-variables" class="nav-link" data-scroll-target="#types-of-variables"><span class="toc-section-number">6.1.3</span>  Types of Variables</a></li>
  <li><a href="#two-major-parts-of-statistics" id="toc-two-major-parts-of-statistics" class="nav-link" data-scroll-target="#two-major-parts-of-statistics"><span class="toc-section-number">6.1.4</span>  Two Major Parts of Statistics</a></li>
  </ul></li>
  <li><a href="#descriptive-statistics-graphical-methods" id="toc-descriptive-statistics-graphical-methods" class="nav-link" data-scroll-target="#descriptive-statistics-graphical-methods"><span class="toc-section-number">6.2</span>  Descriptive Statistics: Graphical Methods</a>
  <ul class="collapse">
  <li><a href="#graphical-methods-for-a-single-variable" id="toc-graphical-methods-for-a-single-variable" class="nav-link" data-scroll-target="#graphical-methods-for-a-single-variable"><span class="toc-section-number">6.2.1</span>  Graphical Methods for a Single Variable</a></li>
  <li><a href="#graphical-methods-for-two-variable-visualization" id="toc-graphical-methods-for-two-variable-visualization" class="nav-link" data-scroll-target="#graphical-methods-for-two-variable-visualization"><span class="toc-section-number">6.2.2</span>  Graphical Methods for Two Variable Visualization</a></li>
  <li><a href="#data-visualization-using-r-introduction-to-grammar-of-graphics" id="toc-data-visualization-using-r-introduction-to-grammar-of-graphics" class="nav-link" data-scroll-target="#data-visualization-using-r-introduction-to-grammar-of-graphics"><span class="toc-section-number">6.2.3</span>  Data Visualization Using R: Introduction to Grammar of Graphics</a></li>
  <li><a href="#visualising-a-single-variable-using-r" id="toc-visualising-a-single-variable-using-r" class="nav-link" data-scroll-target="#visualising-a-single-variable-using-r"><span class="toc-section-number">6.2.4</span>  Visualising a Single Variable using R</a></li>
  <li><a href="#visualising-two-variables-using-r" id="toc-visualising-two-variables-using-r" class="nav-link" data-scroll-target="#visualising-two-variables-using-r"><span class="toc-section-number">6.2.5</span>  Visualising Two Variables using R</a></li>
  <li><a href="#visualizing-three-variables-using-r" id="toc-visualizing-three-variables-using-r" class="nav-link" data-scroll-target="#visualizing-three-variables-using-r"><span class="toc-section-number">6.2.6</span>  Visualizing Three Variables using R</a></li>
  <li><a href="#visualizing-four-variables-using-r" id="toc-visualizing-four-variables-using-r" class="nav-link" data-scroll-target="#visualizing-four-variables-using-r"><span class="toc-section-number">6.2.7</span>  Visualizing Four Variables using R</a></li>
  </ul></li>
  <li><a href="#descriptive-statistics-numerical-methods" id="toc-descriptive-statistics-numerical-methods" class="nav-link" data-scroll-target="#descriptive-statistics-numerical-methods"><span class="toc-section-number">6.3</span>  Descriptive Statistics: Numerical Methods</a>
  <ul class="collapse">
  <li><a href="#types-of-variables-and-summary-measures" id="toc-types-of-variables-and-summary-measures" class="nav-link" data-scroll-target="#types-of-variables-and-summary-measures"><span class="toc-section-number">6.3.1</span>  Types of Variables and Summary Measures</a></li>
  <li><a href="#numerical-methods-for-a-single-variable-using-r" id="toc-numerical-methods-for-a-single-variable-using-r" class="nav-link" data-scroll-target="#numerical-methods-for-a-single-variable-using-r"><span class="toc-section-number">6.3.2</span>  Numerical Methods for a Single Variable using R</a></li>
  <li><a href="#numerical-methods-for-two-variables-using-r" id="toc-numerical-methods-for-two-variables-using-r" class="nav-link" data-scroll-target="#numerical-methods-for-two-variables-using-r"><span class="toc-section-number">6.3.3</span>  Numerical Methods for Two Variables using R</a></li>
  </ul></li>
  <li><a href="#inferential-statistics" id="toc-inferential-statistics" class="nav-link" data-scroll-target="#inferential-statistics"><span class="toc-section-number">6.4</span>  Inferential Statistics</a>
  <ul class="collapse">
  <li><a href="#population-sample-and-sampling-process" id="toc-population-sample-and-sampling-process" class="nav-link" data-scroll-target="#population-sample-and-sampling-process"><span class="toc-section-number">6.4.1</span>  Population, Sample and Sampling Process</a></li>
  <li><a href="#focus-areas" id="toc-focus-areas" class="nav-link" data-scroll-target="#focus-areas"><span class="toc-section-number">6.4.2</span>  Focus Areas</a></li>
  </ul></li>
  <li><a href="#inferential-statistics-hypothesis-testing-and-interval-estimation" id="toc-inferential-statistics-hypothesis-testing-and-interval-estimation" class="nav-link" data-scroll-target="#inferential-statistics-hypothesis-testing-and-interval-estimation"><span class="toc-section-number">6.5</span>  Inferential Statistics: Hypothesis Testing and Interval Estimation</a>
  <ul class="collapse">
  <li><a href="#hypothesis-testing-and-interval-estimation-for-a-mean" id="toc-hypothesis-testing-and-interval-estimation-for-a-mean" class="nav-link" data-scroll-target="#hypothesis-testing-and-interval-estimation-for-a-mean"><span class="toc-section-number">6.5.1</span>  Hypothesis Testing and Interval Estimation for a Mean</a></li>
  <li><a href="#hypothesis-testing-and-interval-estimation-for-two-means" id="toc-hypothesis-testing-and-interval-estimation-for-two-means" class="nav-link" data-scroll-target="#hypothesis-testing-and-interval-estimation-for-two-means"><span class="toc-section-number">6.5.2</span>  Hypothesis Testing and Interval Estimation for Two Means</a></li>
  <li><a href="#hypothesis-testing-and-interval-estimation-for-a-proportion" id="toc-hypothesis-testing-and-interval-estimation-for-a-proportion" class="nav-link" data-scroll-target="#hypothesis-testing-and-interval-estimation-for-a-proportion"><span class="toc-section-number">6.5.3</span>  Hypothesis Testing and Interval Estimation for a Proportion</a></li>
  <li><a href="#chi-squared-test" id="toc-chi-squared-test" class="nav-link" data-scroll-target="#chi-squared-test"><span class="toc-section-number">6.5.4</span>  Chi-Squared Test</a></li>
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova"><span class="toc-section-number">6.5.5</span>  One-way ANOVA</a></li>
  </ul></li>
  <li><a href="#inferential-statistics-regression-analysis" id="toc-inferential-statistics-regression-analysis" class="nav-link" data-scroll-target="#inferential-statistics-regression-analysis"><span class="toc-section-number">6.6</span>  Inferential Statistics: Regression Analysis</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression"><span class="toc-section-number">6.6.1</span>  Simple Linear Regression</a></li>
  <li><a href="#simple-linear-regression-using-r" id="toc-simple-linear-regression-using-r" class="nav-link" data-scroll-target="#simple-linear-regression-using-r"><span class="toc-section-number">6.6.2</span>  Simple Linear Regression Using R</a></li>
  <li><a href="#multiple-linear-regression-using-r" id="toc-multiple-linear-regression-using-r" class="nav-link" data-scroll-target="#multiple-linear-regression-using-r"><span class="toc-section-number">6.6.3</span>  Multiple Linear Regression using R</a></li>
  <li><a href="#logistic-regression-using-r" id="toc-logistic-regression-using-r" class="nav-link" data-scroll-target="#logistic-regression-using-r"><span class="toc-section-number">6.6.4</span>  Logistic Regression using R</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistical Methods</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div style="text-align:justify">
<p>Welcome to the session on Statistical Methods! The goal of this session is to help you understand the fundamental concepts of biostatistics and the different types of variables used in data analysis. By the end of this session, you will be familiar with these concepts and ready to explore the two key branches of statistics: descriptive and inferential.</p>
<p>By the end of this chapter, students will:</p>
<ul>
<li><p>Understand key concepts in biostatistics</p></li>
<li><p>Be able to differentiate between types of variables</p></li>
<li><p>Be able to differentiate between the two major parts of statistics: descriptive and inferential analysis</p></li>
</ul>
</div>
<section id="introduction-to-biostatistics-and-types-of-variables" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction-to-biostatistics-and-types-of-variables"><span class="header-section-number">6.1</span> Introduction to Biostatistics and Types of Variables</h2>
<section id="biostatistics" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="biostatistics"><span class="header-section-number">6.1.1</span> Biostatistics</h3>
<div style="text-align:justify">
<p><strong>Biostatistics</strong> is the application of statistical methods to biological and medical data. It helps clinicians make informed decisions based on data collected from clinical trials, observational studies, and patient records.</p>
<section id="variables" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="variables"><span class="header-section-number">6.1.2</span> Variables</h3>
<p>If, as we observe a characteristic, we find that it takes on different values in different persons, places, or things, we label the characteristic a variable.</p>
<p>For example, if we are observing the characteristic’height’ in a group of people, we will notice that height varies from person to person. Therefore, height is a variable.</p>
</section>
</div>
</section>
<section id="types-of-variables" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="types-of-variables"><span class="header-section-number">6.1.3</span> Types of Variables</h3>
<div style="text-align:justify">
<p>Variables are essential in data analysis and are categorized into four types:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/type_of_variable.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Types of Variables</figcaption><p></p>
</figure>
</div>
<ul>
<li><p><strong>Nominal Variables</strong>: Categorical variables with no inherent order (e.g., blood type: A, B, AB, O).</p></li>
<li><p><strong>Ordinal Variables</strong>: Categorical variables with a meaningful order but unequal intervals (e.g., pain scale: mild, moderate, severe).</p></li>
<li><p><strong>Discrete Variables</strong>: Numerical variables with distinct, countable values (e.g., number of patients in a clinic).</p></li>
<li><p><strong>Continuous Variables</strong>: Numerical variables that can take any value within a range (e.g., patient weight, height).</p></li>
</ul>
</div>
</section>
<section id="two-major-parts-of-statistics" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="two-major-parts-of-statistics"><span class="header-section-number">6.1.4</span> Two Major Parts of Statistics</h3>
<div style="text-align:justify">
<p>Statistics is divided into two main areas:</p>
<ol type="1">
<li><p><strong>Descriptive Statistics</strong>: Summarizing and describing data.</p></li>
<li><p><strong>Inferential Statistics</strong>: Making predictions or inferences about a population based on a sample.</p></li>
</ol>
<p>Explore the following session to deepen your understanding of descriptive and inferential statistical methods, as well as how to implement these techniques using R.</p>
</div>
</section>
</section>
<section id="descriptive-statistics-graphical-methods" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="descriptive-statistics-graphical-methods"><span class="header-section-number">6.2</span> Descriptive Statistics: Graphical Methods</h2>
<div style="text-align:justify">
<p>Graphical methods are crucial for understanding data at a glance. Depending on the number and type of variables, we use different graphical techniques. The graphical methods provided here are just some of the available methods for data visualization. There are many others that can be explored in more detail later. This is intended to be a basic introduction to help you get started.</p>
</div>
<section id="graphical-methods-for-a-single-variable" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="graphical-methods-for-a-single-variable"><span class="header-section-number">6.2.1</span> Graphical Methods for a Single Variable</h3>
<table class="table">
<colgroup>
<col style="width: 32%">
<col style="width: 19%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable Type</strong></th>
<th><strong>Graphical Method</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Categorical (Nominal / Ordinal)</strong></td>
<td>Bar Chart</td>
<td>Shows frequency or proportion of categories</td>
</tr>
<tr class="even">
<td><strong>Discrete (Integer)</strong></td>
<td>Histogram</td>
<td>Displays the count of values across defined intervals</td>
</tr>
<tr class="odd">
<td></td>
<td>Dot Plot</td>
<td>Shows individual data points for small datasets</td>
</tr>
<tr class="even">
<td><strong>Continuous (Double)</strong></td>
<td>Histogram</td>
<td>Shows the frequency distribution of continuous values</td>
</tr>
<tr class="odd">
<td></td>
<td>Box Plot</td>
<td>Displays distribution, including outliers</td>
</tr>
<tr class="even">
<td></td>
<td>Density Plot</td>
<td>Visualizes the density function</td>
</tr>
</tbody>
</table>
</section>
<section id="graphical-methods-for-two-variable-visualization" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="graphical-methods-for-two-variable-visualization"><span class="header-section-number">6.2.2</span> Graphical Methods for Two Variable Visualization</h3>
<table class="table">
<colgroup>
<col style="width: 34%">
<col style="width: 34%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Categorical (Nominal / Ordinal)</strong></th>
<th>Numeric (Discrete / Continuous)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Categorical (Nominal / Ordinal)</strong></td>
<td>Stacked Bar Chart</td>
<td>Box plot</td>
</tr>
<tr class="even">
<td><strong>Numeric (Discrete / Continuous)</strong></td>
<td>Box plot</td>
<td>Scatter Plot</td>
</tr>
</tbody>
</table>
</section>
<section id="data-visualization-using-r-introduction-to-grammar-of-graphics" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="data-visualization-using-r-introduction-to-grammar-of-graphics"><span class="header-section-number">6.2.3</span> Data Visualization Using R: Introduction to Grammar of Graphics</h3>
<div style="text-align:justify">
<p>Data visualization in R can be effectively done using the <code>ggplot2</code> package, which is included in the popular <code>tidyverse</code> collection of R packages. <code>ggplot2</code> is based on the <strong>Grammar of Graphics</strong>, a structured approach that allows you to build plots layer by layer. This grammar provides a framework for describing and creating visualizations by combining different graphical elements. The idea is that any plot can be constructed by breaking it down into components.</p>
<p>The visualisation using <code>ggplot2</code> package, which follows the philosophy of grammar of graphics, breaks down a plot into several components:</p>
<ul>
<li><p><strong>Data</strong>: The dataset you’re working with.</p></li>
<li><p><strong>Aesthetics</strong>: The visual properties (e.g., axes, colors, sizes).</p></li>
<li><p><strong>Geometries</strong>: The type of plot (e.g., points, bars, lines).</p></li>
<li><p><strong>Facets</strong>: Dividing the data into subplots.</p></li>
<li><p><strong>Scales</strong>: Mapping of data values to visual properties.</p></li>
<li><p><strong>Coordinates</strong>: How data is projected onto the plane (e.g., Cartesian coordinates).</p></li>
</ul>
<section id="what-happens-when-you-run-ggplot" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="what-happens-when-you-run-ggplot">What Happens When You Run <code>ggplot()</code>?</h4>
<p>When you run <code>ggplot()</code> in R without specifying any further components, it provides you with a blank “canvas” (or plane) on which you can build your plot. This is like opening a blank sheet of paper to start drawing. Here’s an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(pacman)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> NHANES<span class="sc">::</span>NHANES</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">|&gt;</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df1 <span class="sc">|&gt;</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, survey_yr, gender, age, race1, education, marital_status, hh_income, home_own, home_rooms, poverty, work, weight, height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running ggplot without specifying layers</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This will simply give you a blank plot. You then need to add layers to specify what the plot will contain.</p>
</section>
</div>
<section id="aesthetics-aes" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="aesthetics-aes">Aesthetics (aes)</h4>
<div style="text-align:justify">
<p>Aesthetic mappings define how data is mapped to visual properties. They include properties such as:</p>
<ul>
<li><p>x and y axes: Mapped to variables in your data.</p></li>
<li><p>color: Used to differentiate categories.</p></li>
<li><p>size: Used to represent magnitude or importance.</p></li>
</ul>
<p>For example, when you add aesthetics to ggplot(), it tells R how to map data to the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this example, <code>height</code> is mapped to the x-axis and <code>weight</code> to the y-axis</p>
</div>
</section>
<section id="layers-in-ggplot2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="layers-in-ggplot2">Layers in <code>ggplot2</code></h4>
<div style="text-align:justify">
<p>The power of <code>ggplot2</code> lies in its layering system. After creating the base plot with <code>ggplot()</code>, you can add multiple layers.</p>
<p>You add these layers using the + operator</p>
<p>For Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding layers to create a plot</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height vs Weight"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: NHANES Data"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here’s a breakdown of each layer in the example:</p>
<ul>
<li><p><code>ggplot(df, aes(x = height, y = weight))</code>: This initializes the plot using the <code>df</code> dataset. Inside <code>aes()</code>, the <em>x-axis</em> is mapped to <em>xvariable (height)</em>, and the <em>y-axis</em> is mapped to <em>yvariable (weight)</em>. The aes() function defines aesthetic mappings, determining how data is represented visually.</p></li>
<li><p><code>geom_point()</code>: This adds a geometric layer, specifically a scatter plot, where each point represents an observation. It visualizes the relationship between x and y</p></li>
<li><p><code>labs(title = "Height vs Weight", caption = "Source: NHANES Data")</code>: This layer adds a title and a caption to the plot, making it more interpretable. The title helps to explain what the plot is displaying.</p></li>
</ul>
<p>Each layer builds on the previous one, progressively adding more information to the visualization.</p>
<p><strong><em>Note</em></strong></p>
<p>Every geometric layer starts with <code>geom_</code> in ggplot2.</p>
</div>
</section>
</section>
<section id="visualising-a-single-variable-using-r" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="visualising-a-single-variable-using-r"><span class="header-section-number">6.2.4</span> Visualising a Single Variable using R</h3>
<div style="text-align:justify">
<p>Graphical methods are essential for summarizing and understanding the distribution of a single variable. In this section, we will explore different types of plots for visualizing one variable, based on its type (nominal, ordinal, discrete, or continuous). The key graphical methods include bar charts, boxplots, histograms, and density plots.</p>
</div>
<section id="bar-chart" class="level4" data-number="6.2.4.1">
<h4 data-number="6.2.4.1" class="anchored" data-anchor-id="bar-chart"><span class="header-section-number">6.2.4.1</span> Bar Chart</h4>
<div style="text-align:justify">
<p>A <strong>bar chart</strong> is used to represent categorical data (nominal or ordinal). Each bar represents the frequency (or count) of a category. It’s commonly used for visualizing nominal variables like gender or education level.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart example for a nominal variable</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> gender)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Bar Chart of Gender"</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Gender"</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="boxplot" class="level4" data-number="6.2.4.2">
<h4 data-number="6.2.4.2" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">6.2.4.2</span> Boxplot</h4>
<div style="text-align:justify">
<p>A boxplot is used to represent the distribution of a continuous variable. It shows the median, quartiles, and potential outliers.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot example for a continuous variable</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Height"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="histogram" class="level4" data-number="6.2.4.3">
<h4 data-number="6.2.4.3" class="anchored" data-anchor-id="histogram"><span class="header-section-number">6.2.4.3</span> Histogram</h4>
<div style="text-align:justify">
<p>A histogram is used to visualize the distribution of a continuous variable by dividing the data into bins and counting the number of observations in each bin. It’s useful for understanding the shape, spread, and central tendency of continuous variables like age or income.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram example for a continuous variable</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Height"</span>, <span class="at">x =</span> <span class="st">"Height"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here the x-axis represents height (a continuous variable), and the y-axis represents the frequency of observations in each height bin.</p>
<p>We can make the histogram more attractive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"blue"</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Height"</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="density-plot" class="level4" data-number="6.2.4.4">
<h4 data-number="6.2.4.4" class="anchored" data-anchor-id="density-plot"><span class="header-section-number">6.2.4.4</span> Density Plot</h4>
<div style="text-align:justify">
<p>A density plot is a smoothed version of a histogram, used for continuous data. It provides an estimate of the probability distribution of a continuous variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot example for a continuous variable</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Density Plot of Height"</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Height"</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can represent the area under the curve using any color.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot example for a continuous variable</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Density Plot of Height"</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Height"</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="combining-multiple-geometries-overlaying-histogram-and-density-plot" class="level4" data-number="6.2.4.5">
<h4 data-number="6.2.4.5" class="anchored" data-anchor-id="combining-multiple-geometries-overlaying-histogram-and-density-plot"><span class="header-section-number">6.2.4.5</span> Combining Multiple Geometries: Overlaying Histogram and Density Plot</h4>
<div style="text-align:justify">
<p>One of the strengths of <code>ggplot2</code> is its ability to add multiple geometric shapes (geoms) to a single plot. For example, you can overlay a <strong>density plot</strong> on top of a <strong>histogram</strong> to visualize both the frequency distribution and the smoothed probability distribution of a continuous variable in a single canvas.</p>
<p>Example: Histogram and Density Plot Together</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining histogram and density plot</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Histogram with density scaling</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),        <span class="co"># Normalize the histogram to show density instead of counts</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">2</span>,                <span class="co"># Sets the bin width for the histogram</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span>,               <span class="co"># Fills the bars with blue color</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,             <span class="co"># Outlines the bars with black</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span>                  <span class="co"># Adds transparency to the bars</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Density plot</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),        <span class="co"># Ensures the y-axis of density is consistent</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,               <span class="co"># The density plot will be red</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>                     <span class="co"># Thickness of the density line</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histogram and Density Plot of Height"</span>,  <span class="co"># Title for the plot</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Height"</span>,                                    <span class="co"># X-axis label</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>                                    <span class="co"># Y-axis label</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()                                     <span class="co"># Apply a clean theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
</section>
<section id="visualising-two-variables-using-r" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="visualising-two-variables-using-r"><span class="header-section-number">6.2.5</span> Visualising Two Variables using R</h3>
<div style="text-align:justify">
<p>When working with two variables, visualizing the relationship between them helps reveal patterns, associations, or differences. The appropriate plot depends on the types of variables involved (categorical, continuous, or a combination). In this section, we will explore different graphical methods for visualizing two variables: stacked bar charts, grouped bar charts, scatter plots, box plots by category, and regression lines with standard error.</p>
</div>
<section id="stacked-bar-chart" class="level4" data-number="6.2.5.1">
<h4 data-number="6.2.5.1" class="anchored" data-anchor-id="stacked-bar-chart"><span class="header-section-number">6.2.5.1</span> Stacked Bar Chart</h4>
<div style="text-align:justify">
<p>A <strong>stacked bar chart</strong> is used when both variables are categorical. It displays the distribution of one variable while stacking the bars based on the categories of the second variable.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked bar chart example for two categorical variables</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">fill =</span> race1)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stacked Bar Chart of Gender by Race"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="grouped-bar-chart" class="level4" data-number="6.2.5.2">
<h4 data-number="6.2.5.2" class="anchored" data-anchor-id="grouped-bar-chart"><span class="header-section-number">6.2.5.2</span> Grouped Bar Chart</h4>
<div style="text-align:justify">
<p>A grouped bar chart is another option for visualizing two categorical variables. Instead of stacking the bars, it places bars for each category side-by-side, allowing for a clearer comparison between categories.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped bar chart example for two categorical variables</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> race1, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Grouped Bar Chart of Gender by Race"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="scatter-plot" class="level4" data-number="6.2.5.3">
<h4 data-number="6.2.5.3" class="anchored" data-anchor-id="scatter-plot"><span class="header-section-number">6.2.5.3</span> Scatter Plot</h4>
<div style="text-align:justify">
<p>A scatter plot is used to visualize the relationship between two continuous variables. Each point on the plot represents an observation, and patterns like clusters, trends, or outliers can be detected.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot example for two continuous variables</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height vs Weight"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: NHANES Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="box-plot-by-category" class="level4" data-number="6.2.5.4">
<h4 data-number="6.2.5.4" class="anchored" data-anchor-id="box-plot-by-category"><span class="header-section-number">6.2.5.4</span> Box Plot by Category</h4>
<div style="text-align:justify">
<p>A box plot by category is useful when comparing the distribution of a continuous variable across different categories of a categorical variable. It shows the median, quartiles, and potential outliers within each category.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot example for a continuous variable by category</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Height by Gender"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Height"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="combining-multiple-geometries-scatter-plot-with-regression-line" class="level4" data-number="6.2.5.5">
<h4 data-number="6.2.5.5" class="anchored" data-anchor-id="combining-multiple-geometries-scatter-plot-with-regression-line"><span class="header-section-number">6.2.5.5</span> Combining Multiple Geometries: Scatter Plot with Regression Line</h4>
<div style="text-align:justify">
<p>A scatter plot with a regression line helps visualize the relationship between two continuous variables. Adding a regression line shows the trend, while the standard error (SE) band around the line indicates the uncertainty in the estimate of the relationship.</p>
<p>While regression is an inferential method (used for making predictions or understanding relationships), the purpose of this example is to demonstrate how multiple geometries can be combined when visualizing two variables.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with regression line and SE</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>    <span class="co"># Add scatter plot points</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,                   <span class="co"># Add a regression line</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>,                   <span class="co"># Set the color of the line</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">TRUE</span>,                       <span class="co"># Add the SE band (uncertainty)</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"lightgray"</span>,              <span class="co"># Color of the SE band</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>                      <span class="co"># Set thickness of the line</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatter Plot with Regression Line and SE Band"</span>,  <span class="co"># Title</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Height (cm)"</span>,                                        <span class="co"># X-axis label</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weight (kg)"</span>                                         <span class="co"># Y-axis label</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()                                              <span class="co"># Apply a clean theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-three-variables-using-r" class="level3" data-number="6.2.6">
<h3 data-number="6.2.6" class="anchored" data-anchor-id="visualizing-three-variables-using-r"><span class="header-section-number">6.2.6</span> Visualizing Three Variables using R</h3>
<div style="text-align:justify">
<p>When working with three variables, we can extend basic plots like scatter plots by adding a third variable as an aesthetic element such as color or fill. This allows us to represent more dimensions of the data in a single plot. One common approach is to use <strong>color</strong> to represent a categorical or continuous variable in a scatter plot.</p>
<p>Example: Scatter Plot with Color for a Third Variable</p>
<p>In this example, we’ll create a scatter plot of two continuous variables and use color to represent a third categorical variable. This can help identify patterns or groupings based on the third variable.</p>
</div>
<section id="example" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example">Example</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with color representing a third variable</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> height, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> weight, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> race1)) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of Height vs Weight by Race"</span>, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height"</span>, <span class="at">y =</span> <span class="st">"Weight"</span>, <span class="at">color =</span> <span class="st">"Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Another Way</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with color representing a third variable</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> height, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>race1)<span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of Height vs Weight by Race"</span>, </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height"</span>, <span class="at">y =</span> <span class="st">"Weight"</span>, <span class="at">color =</span> <span class="st">"Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="visualizing-four-variables-using-r" class="level3" data-number="6.2.7">
<h3 data-number="6.2.7" class="anchored" data-anchor-id="visualizing-four-variables-using-r"><span class="header-section-number">6.2.7</span> Visualizing Four Variables using R</h3>
<div style="text-align:justify">
<p>To visualize four variables, we can use a combination of <strong>color</strong> (or fill) for the third variable and <strong>facet wrapping</strong> for the fourth variable. Facet wrapping creates a series of smaller plots based on the levels of a categorical variable, allowing us to compare the relationships across different subgroups.</p>
<p>Example: Scatter Plot with Color and Facet Wrap</p>
<p>In this example, we’ll use a scatter plot with color representing a third variable, and facet wrapping to display different plots for each level of the fourth variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with color and facet wrap for a fourth variable</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> height, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> weight,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>race1)<span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of Height vs Weight by Race and gender"</span>, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height"</span>, <span class="at">y =</span> <span class="st">"Weight"</span>, <span class="at">color =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 366 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="statistical_methods_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
</section>
<section id="descriptive-statistics-numerical-methods" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="descriptive-statistics-numerical-methods"><span class="header-section-number">6.3</span> Descriptive Statistics: Numerical Methods</h2>
<div style="text-align:justify">
<p>Welcome to the world of numerical descriptive methods! These techniques are your go-to tools for exploring data and understanding key concepts like distribution, central tendency, and variability. Think of them as helpful signs that guide you in figuring out how your data works.</p>
<p>These methods can be broadly categorized into two key areas: <a href="https://www.nios.ac.in/media/documents/SecMathcour/Eng/Chapter-25.pdf">measures of central tendency</a> and <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC3198538/">measures of dispersion</a>. Both are crucial for painting a comprehensive picture of your data. However, we won’t be diving too deeply into these measures in this section; you can read more about them through the provided links. Instead, let’s consider something important: the choice of summary measures depends on the type of variable you’re working with. Whether you’re dealing with categorical variables (like nominal and ordinal data) or numeric variables (which can be discrete or continuous), different summary statistics come into play.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/descriptive_stat.jpg" class="img-fluid figure-img" width="300"></p>
<p></p><figcaption class="figure-caption">Image by pikisuperstar on Freepik</figcaption><p></p>
</figure>
</div>
</div>
<p><br></p>
<section id="types-of-variables-and-summary-measures" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="types-of-variables-and-summary-measures"><span class="header-section-number">6.3.1</span> Types of Variables and Summary Measures</h3>
<div style="text-align:justify">
<p>So, what exactly should you use when analyzing your data? Let’s break it down!</p>
</div>
<section id="numerical-methods-for-a-single-variable" class="level4" data-number="6.3.1.1">
<h4 data-number="6.3.1.1" class="anchored" data-anchor-id="numerical-methods-for-a-single-variable"><span class="header-section-number">6.3.1.1</span> Numerical Methods for a Single Variable</h4>
<div style="text-align:justify">
<p>When you’re focusing on just one variable, numerical methods allow you to summarize and analyze your data through various statistical measures. For numeric variables, you can explore measures of central tendency like the mean, median, and mode. These give you a glimpse into the typical values of your dataset. But that’s not all—measures of dispersion, such as standard deviation, variance, and range, tell you how spread out your data is.</p>
<p>And don’t forget about categorical variables! For nominal and ordinal data, you can utilize frequency, proportion, and percentage to get a clearer picture of your dataset.</p>
<p>Here’s a handy table to summarize the types of variables and their corresponding summary measures:</p>
</div>
<table class="table">
<colgroup>
<col style="width: 41%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Type of Variable</strong></th>
<th><strong>Summary Measures</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Categorical (Nominal / Ordinal)</strong></td>
<td>Frequency, Proportion, Percentage, Cumulative proportion</td>
</tr>
<tr class="even">
<td><strong>Numeric</strong> <strong>(Discrete / Continuous)</strong></td>
<td><p>Measures of Central Tendency,</p>
<p>Measures of Dispersion</p></td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
<section id="numerical-methods-for-two-variable" class="level4" data-number="6.3.1.2">
<h4 data-number="6.3.1.2" class="anchored" data-anchor-id="numerical-methods-for-two-variable"><span class="header-section-number">6.3.1.2</span> Numerical Methods for Two Variable</h4>
<div style="text-align:justify">
<p>When you’re analyzing two variables, the methods you choose will depend on the types of variables involved. If you’re working with categorical variables, like nominal and ordinal, you might find yourself comparing frequencies or proportions.</p>
<p>But when numeric variables enter the equation, you’ve got a whole new set of tools at your disposal. Think correlation and comparing means—these methods help you uncover relationships and differences between the variables, bringing you closer to understanding the data dynamics at play.</p>
<p>Here’s a breakdown of some of the choices available to you:</p>
</div>
<table class="table">
<colgroup>
<col style="width: 31%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Type of Variables</strong></th>
<th><strong>Nominal</strong></th>
<th><strong>Ordinal</strong></th>
<th><strong>Numeric (Discrete / Continuous)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Nominal</strong></td>
<td>Cross-tabulation</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Ordinal</strong></td>
<td>Cross-tabulation,</td>
<td><p>Cross-tabulation,</p>
<p>Spearman correlation</p></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Numeric (Discrete / Continuous)</strong></td>
<td>Compare means</td>
<td>Spearman correlation</td>
<td>Correlation</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
</section>
<section id="numerical-methods-for-a-single-variable-using-r" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="numerical-methods-for-a-single-variable-using-r"><span class="header-section-number">6.3.2</span> Numerical Methods for a Single Variable using R</h3>
<div style="text-align:justify">
<p>As we mentioned earlier, there are various ways to describe variables based on their types. In this section, we’ll explore how to describe different variables using R. First, we’ll look at numerical variables (both discrete and continuous), and then we’ll dive into categorical variables (nominal and ordinal).</p>
<div class="cell">

</div>
</div>
<section id="describing-a-single-numerical-discrete-categorical-variable-using-r" class="level4" data-number="6.3.2.1">
<h4 data-number="6.3.2.1" class="anchored" data-anchor-id="describing-a-single-numerical-discrete-categorical-variable-using-r"><span class="header-section-number">6.3.2.1</span> Describing a Single Numerical (Discrete / Categorical) Variable using R</h4>
<div style="text-align:justify">
<p>Now, let’s explore how to describe numerical variables. We can use various measures, including mean, median, range, standard deviation, interquartile range, and percentiles.</p>
</div>
<section id="mean" class="level5" data-number="6.3.2.1.1">
<h5 data-number="6.3.2.1.1" class="anchored" data-anchor-id="mean"><span class="header-section-number">6.3.2.1.1</span> Mean</h5>
<div style="text-align:justify">
<p>The mean is the average of all the data points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_age
     &lt;dbl&gt;
1     36.7</code></pre>
</div>
</div>
<p><strong>Another Way</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36.7421</code></pre>
</div>
</div>
<p>What does <code>df |&gt; pull(age)</code> means. Try yourself!</p>
<p>Now lets find the mean height.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_height
        &lt;dbl&gt;
1          NA</code></pre>
</div>
</div>
<p><strong>Why does the mean height show NA?</strong></p>
<p>When you try calculating the mean of the height variable, you might notice that it returns NA. This happens because some individual observations for height have missing values (NA).</p>
<p>To solve this, we need to tell R to ignore those missing values when performing the calculation. For this, we use an additional argument in the <code>mean()</code> function: <code>na.rm = TRUE</code>. This argument stands for “remove NAs,” and when set to <code>TRUE</code>, it ensures the missing values are ignored, allowing R to calculate the mean based on the available data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean while having NA values</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(height), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  mean_height na.rm
        &lt;dbl&gt; &lt;lgl&gt;
1          NA TRUE </code></pre>
</div>
</div>
<p>By adding this small argument, you’ll get the correct mean without being tripped up by missing data!</p>
</div>
<p><br></p>
</section>
<section id="median" class="level5" data-number="6.3.2.1.2">
<h5 data-number="6.3.2.1.2" class="anchored" data-anchor-id="median"><span class="header-section-number">6.3.2.1.2</span> Median</h5>
<div style="text-align:justify">
<p>The median is the middle value when the data is ordered.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">median_age =</span> <span class="fu">median</span>(age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  median_age
       &lt;dbl&gt;
1         36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">median_height =</span> <span class="fu">median</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  median_height
          &lt;dbl&gt;
1           166</code></pre>
</div>
</div>
<p>Try finding median using <code>pull</code> function from the <code>dplyr</code> package.</p>
<p><br></p>
</div>
</section>
<section id="range" class="level5" data-number="6.3.2.1.3">
<h5 data-number="6.3.2.1.3" class="anchored" data-anchor-id="range"><span class="header-section-number">6.3.2.1.3</span> Range</h5>
<div style="text-align:justify">
<p>The range is the difference between the maximum and minimum values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the range</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">range</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">range</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  83.6 200.4</code></pre>
</div>
</div>
<p>If you want to find the maximum and minimum values separately, you can do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Maximum</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Minimum</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="standard-deviation" class="level5" data-number="6.3.2.1.4">
<h5 data-number="6.3.2.1.4" class="anchored" data-anchor-id="standard-deviation"><span class="header-section-number">6.3.2.1.4</span> Standard Deviation</h5>
<div style="text-align:justify">
<p>Standard deviation measures the amount of variation or dispersion in a variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the standard deviation</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>()</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(<span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><br></p>
</section>
<section id="percentiles" class="level5" data-number="6.3.2.1.5">
<h5 data-number="6.3.2.1.5" class="anchored" data-anchor-id="percentiles"><span class="header-section-number">6.3.2.1.5</span> Percentiles</h5>
<div style="text-align:justify">
<p>Percentiles indicate the relative standing of a value within the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate specific percentiles (e.g., 25th and 75th percentiles)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">probs =</span> <span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25% 
 17 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">probs =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>75% 
 54 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25% 75% 
 17  54 </code></pre>
</div>
</div>
<p><br></p>
</div>
</section>
<section id="inter-quartile-range" class="level5" data-number="6.3.2.1.6">
<h5 data-number="6.3.2.1.6" class="anchored" data-anchor-id="inter-quartile-range"><span class="header-section-number">6.3.2.1.6</span> Inter Quartile Range</h5>
<div style="text-align:justify">
<p>The IQR is the range between the 25th percentile (Q1) and the 75th percentile (Q3).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the IQR</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">IQR</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37</code></pre>
</div>
</div>
<p>There’s another way to approach this. We can estimate the third quartile, which represents the 75th percentile, and the first quartile, which corresponds to the 25th percentile. By calculating the difference between these two values, we arrive at the interquartile range (IQR).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the IQR</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>q_1 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">probs =</span> <span class="fl">0.25</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>q_3 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">probs =</span> <span class="fl">0.75</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>q_3 <span class="sc">-</span> q_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>75% 
 37 </code></pre>
</div>
</div>
</div>
</section>
<section id="combining-multiple-summary-measures" class="level5" data-number="6.3.2.1.7">
<h5 data-number="6.3.2.1.7" class="anchored" data-anchor-id="combining-multiple-summary-measures"><span class="header-section-number">6.3.2.1.7</span> Combining Multiple Summary Measures</h5>
<div style="text-align:justify">
<p>If you want to combine multiple measures as a single outcome, it is also possible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_age =</span> <span class="fu">min</span>(age),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">q1_age =</span> <span class="fu">quantile</span>(age, <span class="at">prob =</span> <span class="fl">0.25</span>), </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_age =</span> <span class="fu">median</span>(age), </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">q3_age =</span> <span class="fu">quantile</span>(age, <span class="at">prob =</span> <span class="fl">0.75</span>),</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_age =</span> <span class="fu">max</span>(age)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  min_age q1_age mean_age median_age q3_age max_age
    &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;int&gt;
1       0     17     36.7         36     54      80</code></pre>
</div>
</div>
<p><br></p>
</div>
</section>
</section>
<section id="describing-a-single-categorical-nominal-ordinal-variable-using-r" class="level4" data-number="6.3.2.2">
<h4 data-number="6.3.2.2" class="anchored" data-anchor-id="describing-a-single-categorical-nominal-ordinal-variable-using-r"><span class="header-section-number">6.3.2.2</span> Describing a Single Categorical (Nominal / Ordinal) Variable using R</h4>
<div style="text-align:justify">
<p>Now let’s dive into categorical variables! When working with categorical data, we often summarize it using frequencies (how often each category appears), percentages (what proportion of the total each category makes up), and cumulative percentages (the running total of those percentages). Let’s explore how to do all of this in a tidy way using R.</p>
<p>We’ll continue working with the NHANES dataset to see this in action.</p>
<p><br></p>
</div>
<section id="frequency" class="level5" data-number="6.3.2.2.1">
<h5 data-number="6.3.2.2.1" class="anchored" data-anchor-id="frequency"><span class="header-section-number">6.3.2.2.1</span> Frequency</h5>
<div style="text-align:justify">
<p>Frequency tells us how many times each category appears in the data. Let’s calculate the frequency for the income variable (<code>hh_income</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the frequency of each category in 'hh_income'</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>hh_income_frequency <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(hh_income)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>hh_income_frequency</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   hh_income         n
   &lt;fct&gt;         &lt;int&gt;
 1 " 0-4999"       192
 2 " 5000-9999"    254
 3 "10000-14999"   543
 4 "15000-19999"   527
 5 "20000-24999"   617
 6 "25000-34999"   958
 7 "35000-44999"   863
 8 "45000-54999"   784
 9 "55000-64999"   621
10 "65000-74999"   526
11 "75000-99999"  1084
12 "more 99999"   2220
13  &lt;NA&gt;           811</code></pre>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="percent" class="level5" data-number="6.3.2.2.2">
<h5 data-number="6.3.2.2.2" class="anchored" data-anchor-id="percent"><span class="header-section-number">6.3.2.2.2</span> Percent</h5>
<div style="text-align:justify">
<p>Next, we’ll calculate the percentage for each category, which shows the relative proportion of each category within the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage for each category in 'hh_income'</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>hh_income_percent <span class="ot">&lt;-</span> df  <span class="sc">|&gt;</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(hh_income) <span class="sc">|&gt;</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> (n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>hh_income_percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   hh_income         n percent
   &lt;fct&gt;         &lt;int&gt;   &lt;dbl&gt;
 1 " 0-4999"       192    1.92
 2 " 5000-9999"    254    2.54
 3 "10000-14999"   543    5.43
 4 "15000-19999"   527    5.27
 5 "20000-24999"   617    6.17
 6 "25000-34999"   958    9.58
 7 "35000-44999"   863    8.63
 8 "45000-54999"   784    7.84
 9 "55000-64999"   621    6.21
10 "65000-74999"   526    5.26
11 "75000-99999"  1084   10.8 
12 "more 99999"   2220   22.2 
13  &lt;NA&gt;           811    8.11</code></pre>
</div>
</div>
<p><br></p>
</div>
</section>
<section id="cumulative-percent" class="level5" data-number="6.3.2.2.3">
<h5 data-number="6.3.2.2.3" class="anchored" data-anchor-id="cumulative-percent"><span class="header-section-number">6.3.2.2.3</span> Cumulative Percent</h5>
<div style="text-align:justify">
<p>Cumulative percent shows the running total of percentages, which can help understand the distribution across categories as you move through them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative percentage for 'hh_income'</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>hh_income_cumulative <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(hh_income) <span class="sc">|&gt;</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cumulative_percent =</span> <span class="fu">cumsum</span>(percent))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>hh_income_cumulative</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 4
   hh_income         n percent cumulative_percent
   &lt;fct&gt;         &lt;int&gt;   &lt;dbl&gt;              &lt;dbl&gt;
 1 " 0-4999"       192    1.92               1.92
 2 " 5000-9999"    254    2.54               4.46
 3 "10000-14999"   543    5.43               9.89
 4 "15000-19999"   527    5.27              15.2 
 5 "20000-24999"   617    6.17              21.3 
 6 "25000-34999"   958    9.58              30.9 
 7 "35000-44999"   863    8.63              39.5 
 8 "45000-54999"   784    7.84              47.4 
 9 "55000-64999"   621    6.21              53.6 
10 "65000-74999"   526    5.26              58.8 
11 "75000-99999"  1084   10.8               69.7 
12 "more 99999"   2220   22.2               91.9 
13  &lt;NA&gt;           811    8.11             100   </code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="publication-ready-tables" class="level4" data-number="6.3.2.3">
<h4 data-number="6.3.2.3" class="anchored" data-anchor-id="publication-ready-tables"><span class="header-section-number">6.3.2.3</span> Publication Ready Tables</h4>
<div style="text-align:justify">
<p>To create publication-ready tables, you can use the <code>gtsummary</code> package in R. Here’s an example of how to generate a summary table for a single variable dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the gtsummary package if not already installed</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("gtsummary")</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(gtsummary)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table for the dataset</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, gender, race1, height) <span class="sc">|&gt;</span> </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>, </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} ({p}%)"</span>),</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="dv">2</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="jjbahtfpzw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jjbahtfpzw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jjbahtfpzw thead, #jjbahtfpzw tbody, #jjbahtfpzw tfoot, #jjbahtfpzw tr, #jjbahtfpzw td, #jjbahtfpzw th {
  border-style: none;
}

#jjbahtfpzw p {
  margin: 0;
  padding: 0;
}

#jjbahtfpzw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jjbahtfpzw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jjbahtfpzw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jjbahtfpzw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jjbahtfpzw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jjbahtfpzw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jjbahtfpzw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jjbahtfpzw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jjbahtfpzw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jjbahtfpzw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jjbahtfpzw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jjbahtfpzw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jjbahtfpzw .gt_spanner_row {
  border-bottom-style: hidden;
}

#jjbahtfpzw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jjbahtfpzw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jjbahtfpzw .gt_from_md > :first-child {
  margin-top: 0;
}

#jjbahtfpzw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jjbahtfpzw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jjbahtfpzw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jjbahtfpzw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jjbahtfpzw .gt_row_group_first td {
  border-top-width: 2px;
}

#jjbahtfpzw .gt_row_group_first th {
  border-top-width: 2px;
}

#jjbahtfpzw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjbahtfpzw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jjbahtfpzw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jjbahtfpzw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jjbahtfpzw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjbahtfpzw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jjbahtfpzw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jjbahtfpzw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jjbahtfpzw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jjbahtfpzw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jjbahtfpzw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjbahtfpzw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jjbahtfpzw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjbahtfpzw .gt_left {
  text-align: left;
}

#jjbahtfpzw .gt_center {
  text-align: center;
}

#jjbahtfpzw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jjbahtfpzw .gt_font_normal {
  font-weight: normal;
}

#jjbahtfpzw .gt_font_bold {
  font-weight: bold;
}

#jjbahtfpzw .gt_font_italic {
  font-style: italic;
}

#jjbahtfpzw .gt_super {
  font-size: 65%;
}

#jjbahtfpzw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jjbahtfpzw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jjbahtfpzw .gt_indent_1 {
  text-indent: 5px;
}

#jjbahtfpzw .gt_indent_2 {
  text-indent: 10px;
}

#jjbahtfpzw .gt_indent_3 {
  text-indent: 15px;
}

#jjbahtfpzw .gt_indent_4 {
  text-indent: 20px;
}

#jjbahtfpzw .gt_indent_5 {
  text-indent: 25px;
}

#jjbahtfpzw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jjbahtfpzw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>"><div data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><div class="gt_from_md"><p><strong>Characteristic</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipOID0gMTAsMDAwKio=&quot;><div class='gt_from_md'><p><strong>N = 10,000</strong></p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KipOID0gMTAsMDAwKio="><div class="gt_from_md"><p><strong>N = 10,000</strong></p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">age</td>
<td headers="stat_0" class="gt_row gt_center">36.74 (22.40)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">gender</td>
<td headers="stat_0" class="gt_row gt_center"><br></td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;female</td>
<td headers="stat_0" class="gt_row gt_center">5,020 (50%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;male</td>
<td headers="stat_0" class="gt_row gt_center">4,980 (50%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">race1</td>
<td headers="stat_0" class="gt_row gt_center"><br></td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Black</td>
<td headers="stat_0" class="gt_row gt_center">1,197 (12%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Hispanic</td>
<td headers="stat_0" class="gt_row gt_center">610 (6.1%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Mexican</td>
<td headers="stat_0" class="gt_row gt_center">1,015 (10%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;White</td>
<td headers="stat_0" class="gt_row gt_center">6,372 (64%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Other</td>
<td headers="stat_0" class="gt_row gt_center">806 (8.1%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">height</td>
<td headers="stat_0" class="gt_row gt_center">161.88 (20.19)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td headers="stat_0" class="gt_row gt_center">353</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span> <div data-qmd-base64="TWVhbiAoU0QpOyBuICglKQ=="><div class="gt_from_md"><p>Mean (SD); n (%)</p>
</div></div></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>Try <code>df |&gt; tbl_summary</code> without selecting variables.</p>
</div>
</section>
</section>
<section id="numerical-methods-for-two-variables-using-r" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="numerical-methods-for-two-variables-using-r"><span class="header-section-number">6.3.3</span> Numerical Methods for Two Variables using R</h3>
<div style="text-align:justify">
<p>In this section, we’ll dive into how to describe relationships between two variables using R. Depending on the types of variables—categorical or numeric—the methods vary. We’ll cover three main scenarios:</p>
<ul>
<li><p>Two categorical variables</p></li>
<li><p>Two numeric variables</p></li>
<li><p>One categorical and one numeric variable</p></li>
</ul>
</div>
<section id="two-categorical-variables" class="level4" data-number="6.3.3.1">
<h4 data-number="6.3.3.1" class="anchored" data-anchor-id="two-categorical-variables"><span class="header-section-number">6.3.3.1</span> Two Categorical Variables</h4>
<div style="text-align:justify">
<p>When working with two categorical variables, one of the most common ways to analyze the relationship between them is by using cross-tabulation.</p>
<p>Cross-tabulation creates a <strong>contingency table</strong> that shows the frequency distribution for each combination of categories.</p>
<p>Let’s use the <code>gender</code> and <code>race1</code> variables in the NHANES dataset to explore this.</p>
</div>
<section id="cross-tabulation" class="level5" data-number="6.3.3.1.1">
<h5 data-number="6.3.3.1.1" class="anchored" data-anchor-id="cross-tabulation"><span class="header-section-number">6.3.3.1.1</span> Cross-Tabulation</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-tabulation of 'gender' and 'race1'</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>gender_race_table <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender, race1)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>gender_race_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   gender race1        n
   &lt;fct&gt;  &lt;fct&gt;    &lt;int&gt;
 1 female Black      614
 2 female Hispanic   320
 3 female Mexican    452
 4 female White     3221
 5 female Other      413
 6 male   Black      583
 7 male   Hispanic   290
 8 male   Mexican    563
 9 male   White     3151
10 male   Other      393</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>This table shows how the categories of gender and race1 are distributed across each other. But to make this even more informative, let’s add percentages.</p>
</div>
</section>
<section id="cross-tabulation-with-percentages" class="level5" data-number="6.3.3.1.2">
<h5 data-number="6.3.3.1.2" class="anchored" data-anchor-id="cross-tabulation-with-percentages"><span class="header-section-number">6.3.3.1.2</span> Cross-Tabulation with Percentages</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-tabulation with percentages</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>gender_race_percent <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender, race1) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>gender_race_percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   gender [2]
   gender race1        n percent
   &lt;fct&gt;  &lt;fct&gt;    &lt;int&gt;   &lt;dbl&gt;
 1 female Black      614   12.2 
 2 female Hispanic   320    6.37
 3 female Mexican    452    9.00
 4 female White     3221   64.2 
 5 female Other      413    8.23
 6 male   Black      583   11.7 
 7 male   Hispanic   290    5.82
 8 male   Mexican    563   11.3 
 9 male   White     3151   63.3 
10 male   Other      393    7.89</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>This output gives us a clearer picture of the relationship between the two categorical variables by showing the percentage of each race within each gender group.</p>
</div>
</section>
</section>
<section id="two-numeric-variables" class="level4" data-number="6.3.3.2">
<h4 data-number="6.3.3.2" class="anchored" data-anchor-id="two-numeric-variables"><span class="header-section-number">6.3.3.2</span> Two Numeric Variables</h4>
<div style="text-align:justify">
<p>When both variables are numeric, we can correlation to explore the relationship between them.</p>
</div>
<section id="correlation" class="level5" data-number="6.3.3.2.1">
<h5 data-number="6.3.3.2.1" class="anchored" data-anchor-id="correlation"><span class="header-section-number">6.3.3.2.1</span> Correlation</h5>
<div style="text-align:justify">
<p>Correlation measures the strength and direction of the linear relationship between two numeric variables. The most common measure is Pearson’s correlation coefficient.</p>
<p>Let’s calculate the correlation between <code>height</code> and <code>weight</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(height, weight) <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">correlation =</span> <span class="fu">cor</span>(height, weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  correlation
        &lt;dbl&gt;
1       0.749</code></pre>
</div>
</div>
<p><strong>Another Way</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between height and weight</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">correlation =</span> <span class="fu">cor</span>(height, weight, <span class="at">use =</span> <span class="st">"complete.obs"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  correlation
        &lt;dbl&gt;
1       0.749</code></pre>
</div>
</div>
<p>Here, <code>use = "complete.obs"</code> ensures that rows with missing values (NA) are ignored during the correlation calculation, just like <code>na.rm = TRUE</code> would do.</p>
</div>
</section>
</section>
<section id="one-categorical-and-one-numeric-variables" class="level4" data-number="6.3.3.3">
<h4 data-number="6.3.3.3" class="anchored" data-anchor-id="one-categorical-and-one-numeric-variables"><span class="header-section-number">6.3.3.3</span> One categorical and One Numeric Variables</h4>
<div style="text-align:justify">
<p>When you have one categorical and one numeric variable, you’re often interested in comparing the distribution of the numeric variable across different categories. Group-wise summaries and box plots are common methods for this.</p>
<p>Let’s look at the relationship between gender (categorical) and height (numeric).</p>
<p>Group-Wise Summaries We can calculate summary statistics (like mean and median) for height within each gender category.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group-wise summary of height by gender</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_height =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_height =</span> <span class="fu">median</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_height =</span> <span class="fu">sd</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_height =</span> <span class="fu">IQR</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  gender mean_height median_height sd_height iqr_height
  &lt;fct&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 female        157.          161.      16.8       11.6
2 male          167.          174.      21.9       13.2</code></pre>
</div>
</div>
</section>
<section id="publication-ready-tables-for-two-variables" class="level4" data-number="6.3.3.4">
<h4 data-number="6.3.3.4" class="anchored" data-anchor-id="publication-ready-tables-for-two-variables"><span class="header-section-number">6.3.3.4</span> Publication Ready Tables for Two Variables</h4>
<div style="text-align:justify">
<p>When you need to present results in a polished, publication-ready format, the gtsummary package in R is an excellent tool. It allows you to easily create clean, professional tables summarizing relationships between two variables. Below is an example of how you can use gtsummary to generate a table for a two-variable analysis, showcasing how your results can be made ready for publication.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a publication-ready table for two categorical variables</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>table_cat <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, race1) <span class="sc">%&gt;%</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> gender, </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> race1 <span class="sc">~</span> <span class="st">"Race/Ethnicity"</span>) </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>table_cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="msngvefrlc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#msngvefrlc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#msngvefrlc thead, #msngvefrlc tbody, #msngvefrlc tfoot, #msngvefrlc tr, #msngvefrlc td, #msngvefrlc th {
  border-style: none;
}

#msngvefrlc p {
  margin: 0;
  padding: 0;
}

#msngvefrlc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#msngvefrlc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#msngvefrlc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#msngvefrlc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#msngvefrlc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msngvefrlc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msngvefrlc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msngvefrlc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#msngvefrlc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#msngvefrlc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#msngvefrlc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#msngvefrlc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#msngvefrlc .gt_spanner_row {
  border-bottom-style: hidden;
}

#msngvefrlc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#msngvefrlc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#msngvefrlc .gt_from_md > :first-child {
  margin-top: 0;
}

#msngvefrlc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#msngvefrlc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#msngvefrlc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#msngvefrlc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#msngvefrlc .gt_row_group_first td {
  border-top-width: 2px;
}

#msngvefrlc .gt_row_group_first th {
  border-top-width: 2px;
}

#msngvefrlc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngvefrlc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#msngvefrlc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#msngvefrlc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msngvefrlc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngvefrlc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#msngvefrlc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#msngvefrlc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#msngvefrlc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msngvefrlc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msngvefrlc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngvefrlc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msngvefrlc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngvefrlc .gt_left {
  text-align: left;
}

#msngvefrlc .gt_center {
  text-align: center;
}

#msngvefrlc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#msngvefrlc .gt_font_normal {
  font-weight: normal;
}

#msngvefrlc .gt_font_bold {
  font-weight: bold;
}

#msngvefrlc .gt_font_italic {
  font-style: italic;
}

#msngvefrlc .gt_super {
  font-size: 65%;
}

#msngvefrlc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#msngvefrlc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#msngvefrlc .gt_indent_1 {
  text-indent: 5px;
}

#msngvefrlc .gt_indent_2 {
  text-indent: 10px;
}

#msngvefrlc .gt_indent_3 {
  text-indent: 15px;
}

#msngvefrlc .gt_indent_4 {
  text-indent: 20px;
}

#msngvefrlc .gt_indent_5 {
  text-indent: 25px;
}

#msngvefrlc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#msngvefrlc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>"><div data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><div class="gt_from_md"><p><strong>Characteristic</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipmZW1hbGUqKiAgCk4gPSA1LDAyMA==&quot;><div class='gt_from_md'><p><strong>female</strong><br />
N = 5,020</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KipmZW1hbGUqKiAgCk4gPSA1LDAyMA=="><div class="gt_from_md"><p><strong>female</strong><br>
N = 5,020</p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KiptYWxlKiogIApOID0gNCw5ODA=&quot;><div class='gt_from_md'><p><strong>male</strong><br />
N = 4,980</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KiptYWxlKiogIApOID0gNCw5ODA="><div class="gt_from_md"><p><strong>male</strong><br>
N = 4,980</p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Race/Ethnicity</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Black</td>
<td headers="stat_1" class="gt_row gt_center">614 (12%)</td>
<td headers="stat_2" class="gt_row gt_center">583 (12%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Hispanic</td>
<td headers="stat_1" class="gt_row gt_center">320 (6.4%)</td>
<td headers="stat_2" class="gt_row gt_center">290 (5.8%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Mexican</td>
<td headers="stat_1" class="gt_row gt_center">452 (9.0%)</td>
<td headers="stat_2" class="gt_row gt_center">563 (11%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;White</td>
<td headers="stat_1" class="gt_row gt_center">3,221 (64%)</td>
<td headers="stat_2" class="gt_row gt_center">3,151 (63%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Other</td>
<td headers="stat_1" class="gt_row gt_center">413 (8.2%)</td>
<td headers="stat_2" class="gt_row gt_center">393 (7.9%)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span> <div data-qmd-base64="biAoJSk="><div class="gt_from_md"><p>n (%)</p>
</div></div></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>If you’re comparing a numeric variable across categories (e.g., height by gender), use the <code>tbl_summary()</code> function with the <code>by</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a publication-ready table for a categorical and a numeric variables</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>table_cat_num <span class="ot">&lt;-</span> df  <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height) <span class="sc">|&gt;</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> gender, </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> height <span class="sc">~</span> <span class="st">"Height"</span>) </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>table_cat_num</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ziamrfadch" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ziamrfadch table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ziamrfadch thead, #ziamrfadch tbody, #ziamrfadch tfoot, #ziamrfadch tr, #ziamrfadch td, #ziamrfadch th {
  border-style: none;
}

#ziamrfadch p {
  margin: 0;
  padding: 0;
}

#ziamrfadch .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ziamrfadch .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ziamrfadch .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ziamrfadch .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ziamrfadch .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ziamrfadch .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ziamrfadch .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ziamrfadch .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ziamrfadch .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ziamrfadch .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ziamrfadch .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ziamrfadch .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ziamrfadch .gt_spanner_row {
  border-bottom-style: hidden;
}

#ziamrfadch .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ziamrfadch .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ziamrfadch .gt_from_md > :first-child {
  margin-top: 0;
}

#ziamrfadch .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ziamrfadch .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ziamrfadch .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ziamrfadch .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ziamrfadch .gt_row_group_first td {
  border-top-width: 2px;
}

#ziamrfadch .gt_row_group_first th {
  border-top-width: 2px;
}

#ziamrfadch .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ziamrfadch .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ziamrfadch .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ziamrfadch .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ziamrfadch .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ziamrfadch .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ziamrfadch .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ziamrfadch .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ziamrfadch .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ziamrfadch .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ziamrfadch .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ziamrfadch .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ziamrfadch .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ziamrfadch .gt_left {
  text-align: left;
}

#ziamrfadch .gt_center {
  text-align: center;
}

#ziamrfadch .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ziamrfadch .gt_font_normal {
  font-weight: normal;
}

#ziamrfadch .gt_font_bold {
  font-weight: bold;
}

#ziamrfadch .gt_font_italic {
  font-style: italic;
}

#ziamrfadch .gt_super {
  font-size: 65%;
}

#ziamrfadch .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ziamrfadch .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ziamrfadch .gt_indent_1 {
  text-indent: 5px;
}

#ziamrfadch .gt_indent_2 {
  text-indent: 10px;
}

#ziamrfadch .gt_indent_3 {
  text-indent: 15px;
}

#ziamrfadch .gt_indent_4 {
  text-indent: 20px;
}

#ziamrfadch .gt_indent_5 {
  text-indent: 25px;
}

#ziamrfadch .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ziamrfadch div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>"><div data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><div class="gt_from_md"><p><strong>Characteristic</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipmZW1hbGUqKiAgCk4gPSA0LDg0Nw==&quot;><div class='gt_from_md'><p><strong>female</strong><br />
N = 4,847</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KipmZW1hbGUqKiAgCk4gPSA0LDg0Nw=="><div class="gt_from_md"><p><strong>female</strong><br>
N = 4,847</p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KiptYWxlKiogIApOID0gNCw4MDA=&quot;><div class='gt_from_md'><p><strong>male</strong><br />
N = 4,800</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KiptYWxlKiogIApOID0gNCw4MDA="><div class="gt_from_md"><p><strong>male</strong><br>
N = 4,800</p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Height</td>
<td headers="stat_1" class="gt_row gt_center">161 (154, 166)</td>
<td headers="stat_2" class="gt_row gt_center">174 (166, 179)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span> <div data-qmd-base64="TWVkaWFuIChRMSwgUTMp"><div class="gt_from_md"><p>Median (Q1, Q3)</p>
</div></div></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>If you need mean and standard deviation instead of median and IQR, then</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>table_cat_num <span class="ot">&lt;-</span> df  <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height) <span class="sc">|&gt;</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> gender,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>table_cat_num</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ybjzcjmbjk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ybjzcjmbjk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ybjzcjmbjk thead, #ybjzcjmbjk tbody, #ybjzcjmbjk tfoot, #ybjzcjmbjk tr, #ybjzcjmbjk td, #ybjzcjmbjk th {
  border-style: none;
}

#ybjzcjmbjk p {
  margin: 0;
  padding: 0;
}

#ybjzcjmbjk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ybjzcjmbjk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ybjzcjmbjk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ybjzcjmbjk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ybjzcjmbjk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ybjzcjmbjk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ybjzcjmbjk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ybjzcjmbjk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ybjzcjmbjk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ybjzcjmbjk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ybjzcjmbjk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ybjzcjmbjk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ybjzcjmbjk .gt_spanner_row {
  border-bottom-style: hidden;
}

#ybjzcjmbjk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ybjzcjmbjk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ybjzcjmbjk .gt_from_md > :first-child {
  margin-top: 0;
}

#ybjzcjmbjk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ybjzcjmbjk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ybjzcjmbjk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ybjzcjmbjk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ybjzcjmbjk .gt_row_group_first td {
  border-top-width: 2px;
}

#ybjzcjmbjk .gt_row_group_first th {
  border-top-width: 2px;
}

#ybjzcjmbjk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybjzcjmbjk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ybjzcjmbjk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ybjzcjmbjk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ybjzcjmbjk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybjzcjmbjk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ybjzcjmbjk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ybjzcjmbjk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ybjzcjmbjk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ybjzcjmbjk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ybjzcjmbjk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybjzcjmbjk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ybjzcjmbjk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybjzcjmbjk .gt_left {
  text-align: left;
}

#ybjzcjmbjk .gt_center {
  text-align: center;
}

#ybjzcjmbjk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ybjzcjmbjk .gt_font_normal {
  font-weight: normal;
}

#ybjzcjmbjk .gt_font_bold {
  font-weight: bold;
}

#ybjzcjmbjk .gt_font_italic {
  font-style: italic;
}

#ybjzcjmbjk .gt_super {
  font-size: 65%;
}

#ybjzcjmbjk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ybjzcjmbjk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ybjzcjmbjk .gt_indent_1 {
  text-indent: 5px;
}

#ybjzcjmbjk .gt_indent_2 {
  text-indent: 10px;
}

#ybjzcjmbjk .gt_indent_3 {
  text-indent: 15px;
}

#ybjzcjmbjk .gt_indent_4 {
  text-indent: 20px;
}

#ybjzcjmbjk .gt_indent_5 {
  text-indent: 25px;
}

#ybjzcjmbjk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ybjzcjmbjk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>"><div data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><div class="gt_from_md"><p><strong>Characteristic</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipmZW1hbGUqKiAgCk4gPSA0LDg0Nw==&quot;><div class='gt_from_md'><p><strong>female</strong><br />
N = 4,847</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KipmZW1hbGUqKiAgCk4gPSA0LDg0Nw=="><div class="gt_from_md"><p><strong>female</strong><br>
N = 4,847</p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KiptYWxlKiogIApOID0gNCw4MDA=&quot;><div class='gt_from_md'><p><strong>male</strong><br />
N = 4,800</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="KiptYWxlKiogIApOID0gNCw4MDA="><div class="gt_from_md"><p><strong>male</strong><br>
N = 4,800</p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">height</td>
<td headers="stat_1" class="gt_row gt_center">157 (17)</td>
<td headers="stat_2" class="gt_row gt_center">167 (22)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span> <div data-qmd-base64="TWVhbiAoU0Qp"><div class="gt_from_md"><p>Mean (SD)</p>
</div></div></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="inferential-statistics" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="inferential-statistics"><span class="header-section-number">6.4</span> Inferential Statistics</h2>
<div style="text-align:justify">
<p>Inferential statistics is a branch of statistics that allows us to make conclusions about a population based on a sample of data drawn from that population. Unlike descriptive statistics, which focuses on summarizing and describing data, inferential statistics enables researchers to draw conclusions, make predictions, and test hypotheses, making it a crucial tool in various fields, including healthcare, public health, social sciences, and business.</p>
</div>
<section id="population-sample-and-sampling-process" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="population-sample-and-sampling-process"><span class="header-section-number">6.4.1</span> Population, Sample and Sampling Process</h3>
<div style="text-align:justify">
<p>Inferential statistics operates on the fundamental idea that we can infer characteristics of a population from a carefully selected sample. Since studying an entire population is often impractical or impossible due to time, cost, or accessibility constraints, researchers rely on samples. The goal is to use the sample data to draw conclusions or make estimates about the larger population.</p>
<ul>
<li><p><strong>Population:</strong> This refers to the entire group of individuals or items that we are interested in studying. For example, in a medical study, the population could be all individuals with a certain medical condition.</p></li>
<li><p><strong>Sample:</strong> A sample is a subset of the population that is selected for analysis. The sample must be representative of the population to ensure that the inferences made are valid. For example, selecting 500 individuals with the condition from different regions provides a sample from the larger population.</p></li>
<li><p><strong>Sampling Process:</strong> The sampling process involves selecting individuals from the population in a way that ensures the sample reflects the population’s characteristics.</p></li>
</ul>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/pop_sample.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image modified from <a href="https://pressbooks.bccampus.ca/jibcresearchmethods/chapter/7-2-population-versus-samples/">“Research Methods for the Social Sciences: An Introduction</a>” (2020) by Valerie Sheppard.</figcaption><p></p>
</figure>
</div>
</section>
<section id="focus-areas" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="focus-areas"><span class="header-section-number">6.4.2</span> Focus Areas</h3>
<div style="text-align:justify">
<p>In following chapters, we are focusing on three key areas of inferential statistics:</p>
<ul>
<li><p>Hypothesis Testing</p></li>
<li><p>Interval Estimation</p></li>
<li><p>Regression Analysis</p></li>
</ul>
<p>Each of these areas plays a crucial role in understanding and applying inferential methods effectively. We will also explore how to implement these concepts using R, providing you with practical tools to analyze data and draw meaningful conclusions.</p>
</div>
</section>
</section>
<section id="inferential-statistics-hypothesis-testing-and-interval-estimation" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="inferential-statistics-hypothesis-testing-and-interval-estimation"><span class="header-section-number">6.5</span> Inferential Statistics: Hypothesis Testing and Interval Estimation</h2>
<div style="text-align:justify">
<p>In inferential statistics, hypothesis testing and interval estimation are core methods used to make conclusions about a population from sample data. While hypothesis testing determines if there is enough evidence to reject a null hypothesis, interval estimation provides a range of values (confidence intervals) likely to contain the true population parameter. Together, these tools form the basis of statistical inference.</p>
<p>In this chapter, we explore hypothesis testing and interval estimation for various scenarios using R, including means, proportions, and categorical variables. We focus on practical implementation and provide references for more in-depth theoretical understanding. For a more in-depth understanding, refer to additional resources.</p>
<ul>
<li><p><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2996198/">Hypothesis testing, type I and type II errors</a>: This paper explores the essentials of hypothesis testing in research, covering characteristics and types of hypotheses, statistical principles, type I and type II errors, effect size, alpha and beta, statistical power, and p-values <span class="citation" data-cites="banerjee2009">(<a href="#ref-banerjee2009" role="doc-biblioref">Banerjee et al. 2009</a>)</span>.</p></li>
<li><p><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7807926/pdf/main.pdf">Hypothesis Tests</a>: This article aims to provide readers with a clear understanding of the purpose of hypothesis testing, guidance on selecting the appropriate test for various research scenarios using a reference table, and insights into interpreting p-values effectively <span class="citation" data-cites="walker2019">(<a href="#ref-walker2019" role="doc-biblioref">Walker 2019</a>)</span>.</p></li>
<li><p><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC5723800/pdf/jtd-09-10-4125.pdf">Using the confidence interval confidently</a>: The paper discusses the application and significance of confidence intervals (CIs) in biomedical research, particularly for estimating population parameters based on sample data. It outlines the process of calculating CIs, noting that the margin of error depends on sample variability, sample size, and confidence level. The authors highlight how CIs provide more meaningful insights than p-values alone by offering an estimated range for effect size, which is crucial for assessing clinical relevance. <span class="citation" data-cites="hazra2017">(<a href="#ref-hazra2017" role="doc-biblioref">Hazra 2017</a>)</span></p></li>
</ul>
</div>
<section id="hypothesis-testing-and-interval-estimation-for-a-mean" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="hypothesis-testing-and-interval-estimation-for-a-mean"><span class="header-section-number">6.5.1</span> Hypothesis Testing and Interval Estimation for a Mean</h3>
<section id="one-sample-t-test-hypothesis-testing" class="level4" data-number="6.5.1.1">
<h4 data-number="6.5.1.1" class="anchored" data-anchor-id="one-sample-t-test-hypothesis-testing"><span class="header-section-number">6.5.1.1</span> One-Sample T-Test: Hypothesis Testing</h4>
<div style="text-align:justify">
<p>The one-sample t-test is a statistical method that compares the mean of a sample to a known reference value—usually a population mean—to assess if there is a significant difference.</p>
<p>In this context, using the NHANES dataset, we can investigate whether the mean blood pressure (BP) of a sample of adults differs significantly from the standard “normal” BP value, which is often considered to be around 120 mmHg for systolic pressure.</p>
<p><strong>Hypotheses:</strong></p>
<p><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</strong>: The mean systolic blood pressure of the sample is equal to the normal value (120 mmHg).</p>
<p><strong>Alternative Hypothesis (<span class="math inline">\(H_1\)</span>)</strong>: The mean systolic blood pressure of the sample differs from 120 mmHg.</p>
<p><strong>R Implementation</strong>: We’ll use the <code>t.test()</code> function to conduct the one-sample t-test, specifying 120 as the value for comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load NHANES data</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> NHANES<span class="sc">::</span>NHANES</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bp_sys_post =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    bmi <span class="sc">&gt;</span> <span class="dv">25</span> <span class="sc">~</span> <span class="fu">round</span>(bp_sys_ave <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="dv">0</span>),  <span class="co"># Generate a new random number for each row</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(bp_sys_ave <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dv">0</span>)        <span class="co"># Same for those with bmi &lt;= 25</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to include only adults</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">18</span>)</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct a one-sample t-test</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(df<span class="sc">$</span>bp_sys_ave, <span class="at">mu =</span> <span class="dv">120</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="co"># View the result</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>t_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  df$bp_sys_ave
t = 3.6188, df = 7204, p-value = 0.0002981
alternative hypothesis: true mean is not equal to 120
95 percent confidence interval:
 120.3334 121.1215
sample estimates:
mean of x 
 120.7274 </code></pre>
</div>
</div>
<p><strong>Interpretation of Results:</strong></p>
<ul>
<li><p>t-Statistic: 3.618</p></li>
<li><p>Degrees of Freedom: 7,204</p></li>
<li><p>p-value: 0.0002981</p></li>
</ul>
<p><strong>Conclusion</strong>: With a p-value of 0.0003 (below 0.05), we conclude that the sample’s average blood pressure of 120.73 mmHg is statistically different from the normal BP value of 120 mmHg. However, for clinicians, it’s essential to think about what this small difference actually means for patient care.</p>
<p>In this case, while there’s a statistically significant difference, the 0.73 mmHg increase from the standard value is likely too small to have clinical importance. This reminds us that even if a result is statistically significant, it’s the practical impact on patient outcomes that ultimately matters.</p>
</div>
</section>
<section id="one-sample-t-test-interval-estimation" class="level4" data-number="6.5.1.2">
<h4 data-number="6.5.1.2" class="anchored" data-anchor-id="one-sample-t-test-interval-estimation"><span class="header-section-number">6.5.1.2</span> One-Sample T-Test: Interval Estimation</h4>
<div style="text-align:justify">
<p>In addition to hypothesis testing, we also estimate a confidence interval (CI) for the mean systolic blood pressure of the sample. The confidence interval provides a range of values that likely contains the true mean systolic blood pressure of the population.</p>
<p><strong>95% Confidence Interval Calculation:</strong></p>
<p>From our one-sample t-test results, we can compute the 95% confidence interval for the mean blood pressure:</p>
<ul>
<li><p>95% Confidence Interval for Mean BP: (120.33, 121.12)</p></li>
<li><p>Sample Mean: 120.73 mmHg</p></li>
</ul>
<p>The confidence interval indicates that we can be 95% confident that the true mean systolic blood pressure of the population lies between 120.33 mmHg and 121.12 mmHg. This information is particularly valuable in clinical practice, as it not only provides an estimate of the mean but also conveys the degree of uncertainty around that estimate.</p>
<p>While the average blood pressure of 120.73 mmHg is statistically significant, the width of the confidence interval (0.79 mmHg) suggests that there is little variability in our estimate, reinforcing the notion that this slight increase from the standard value may lack clinical importance.</p>
<p>Ultimately, this dual approach—hypothesis testing combined with interval estimation—allows for a more comprehensive understanding of the data and its implications for patient care.</p>
</div>
</section>
</section>
<section id="hypothesis-testing-and-interval-estimation-for-two-means" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="hypothesis-testing-and-interval-estimation-for-two-means"><span class="header-section-number">6.5.2</span> Hypothesis Testing and Interval Estimation for Two Means</h3>
<section id="two-sample-t-test-hypothesis-testing" class="level4" data-number="6.5.2.1">
<h4 data-number="6.5.2.1" class="anchored" data-anchor-id="two-sample-t-test-hypothesis-testing"><span class="header-section-number">6.5.2.1</span> Two-Sample T-Test: Hypothesis Testing</h4>
<div style="text-align:justify">
<p>The two-sample t-test is a statistical method used to compare the means of two independent groups. In this context, we will examine whether there is a significant difference in height between males and females using the NHANES dataset.</p>
<p><strong>Hypotheses:</strong></p>
<p><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): There is no difference in the mean height between males and females.</p>
<p><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_1\)</span>): : There is a difference in the mean height between males and females.</p>
<p><strong>Conduct the Test in R</strong>: Assuming we have loaded and cleaned the NHANES dataset, we can perform the two-sample t-test on height.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-test for height difference between males and females</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>t_test_height <span class="ot">&lt;-</span> <span class="fu">t.test</span>(height <span class="sc">~</span> gender, <span class="at">data =</span> df, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>t_test_height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  height by gender
t = -80.661, df = 7422, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group female and group male is not equal to 0
95 percent confidence interval:
 -14.15018 -13.47872
sample estimates:
mean in group female   mean in group male 
            162.0562             175.8707 </code></pre>
</div>
</div>
<p>In the t.test() function in R, the argument var.equal = TRUE specifies that we assume the two groups have equal variances. By default, the two-sample t-test in R does not assume equal variances (this is called Welch’s t-test). When var.equal = TRUE, we perform a pooled two-sample t-test, where the variances from each group are combined (or “pooled”) to estimate a common variance.</p>
<p><strong>Interpretation of Results</strong></p>
<ul>
<li><p>t-Statistic: -80.661</p></li>
<li><p>Degrees of Freedom (df): 7,422</p></li>
<li><p>p-value: &lt; 2.2e-16</p></li>
</ul>
<p><strong>Conclusion:</strong> The very low p-value (&lt; 0.05) indicates that we reject the null hypothesis, suggesting that there is a statistically significant difference in average height between males and females in this sample.</p>
</div>
</section>
<section id="two-sample-t-test-confidence-interval" class="level4" data-number="6.5.2.2">
<h4 data-number="6.5.2.2" class="anchored" data-anchor-id="two-sample-t-test-confidence-interval"><span class="header-section-number">6.5.2.2</span> Two-Sample T-Test: Confidence Interval</h4>
<div style="text-align:justify">
<p>In addition to hypothesis testing, it is important to calculate the confidence interval for the difference in means to provide further context regarding the effect size.</p>
<p><strong>95% Confidence Interval for the Difference in Means:</strong></p>
<p><strong>Confidence Interval:</strong> (-14.15, -13.48) This interval suggests that males are, on average, between 13.48 and 14.15 cm taller than females.</p>
<p><strong>Interpretation of the Confidence Interval:</strong></p>
<ul>
<li><p>95% Confidence Interval for the Difference in Means: (-14.15, -13.48)</p></li>
<li><p>Sample Means:</p>
<ul>
<li>Female: 162.06 cm</li>
<li>Male: 175.87 cm</li>
</ul></li>
</ul>
<p>The confidence interval provides a range of values that, with 95% confidence, includes the true difference in average height between males and females. Since the entire interval is negative, this reinforces our earlier conclusion that males are significantly taller than females.</p>
</div>
</section>
<section id="paired-t-test-hypothesis-testing" class="level4" data-number="6.5.2.3">
<h4 data-number="6.5.2.3" class="anchored" data-anchor-id="paired-t-test-hypothesis-testing"><span class="header-section-number">6.5.2.3</span> Paired T-Test: Hypothesis Testing</h4>
<div style="text-align:justify">
<p>The paired t-test is a statistical method used to compare two related samples, measuring the same group at two different times.</p>
<p>For example, to examine the effect of an intervention, a paired t-test can be used to compare blood pressure (BP) measurements taken pre- and post-intervention among individuals with a BMI greater than 25.</p>
<p>The paired t-test is ideal for dependent samples, where each individual has measurements in both conditions (pre and post), allowing us to assess whether the intervention significantly impacted BP.</p>
<p>For the paired t-test examining blood pressure changes before and after an intervention among individuals with a BMI over 25, the hypotheses can be outlined as follows:</p>
<p><strong>Hypotheses:</strong></p>
<p><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): The mean systolic blood pressure before the intervention is equal to the mean blood pressure after the intervention for individuals with a BMI greater than 25. This implies that the intervention had no effect on blood pressure.</p>
<p><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_1\)</span>): The mean systolic blood pressure before the intervention is different from the mean blood pressure after the intervention for individuals with a BMI greater than 25, suggesting a potential effect of the intervention on blood pressure.</p>
<p>If the test results in a p-value less than our significance threshold (typically 0.05), we would reject the null hypothesis and conclude that there is a statistically significant difference in blood pressure, likely attributable to the intervention.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataset for individuals with BMI &gt; 25</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>df_filtered <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bmi <span class="sc">&gt;</span> <span class="dv">25</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a paired t-test</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  df_filtered<span class="sc">$</span>bp_sys_post,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  df_filtered<span class="sc">$</span>bp_sys_ave,</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>t_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  df_filtered$bp_sys_post and df_filtered$bp_sys_ave
t = -150.68, df = 4855, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -4.512445 -4.396533
sample estimates:
mean difference 
      -4.454489 </code></pre>
</div>
</div>
<p><strong>Paired t-Test Results Interpretation</strong></p>
<ul>
<li><p>t-statistic: -150.86</p></li>
<li><p>Degrees of Freedom (df): 4855</p></li>
<li><p>p-value: &lt; 2.2e-16</p></li>
</ul>
<p>The t-statistic is -155.16, indicating a significant difference in systolic blood pressure (BP) between the average pre-intervention and post-intervention measurements.The degrees of freedom is 4855, indicating a large sample size, which adds robustness to the statistical findings.</p>
<p>The p-value is &lt; 2.2e-16, which is extremely low and suggests a statistically significant difference in systolic blood pressure before and after the intervention. Since this p-value is well below the standard threshold of 0.05, we reject the null hypothesis, indicating that there is a meaningful change in BP levels.</p>
<section id="paired-t-test-confidence-interval" class="level4" data-number="6.5.2.4">
<h4 data-number="6.5.2.4" class="anchored" data-anchor-id="paired-t-test-confidence-interval"><span class="header-section-number">6.5.2.4</span> Paired T-Test: Confidence Interval</h4>
<p>The 95% confidence interval for the mean difference is (-4.529483, -4.413268). This interval indicates that we can be 95% confident that the true mean decrease in systolic blood pressure lies between -4.53 mmHg and -4.41 mmHg. Since the entire interval is negative, this strongly supports the conclusion that the intervention has led to a significant reduction in systolic BP.</p>
<p>The mean difference in systolic blood pressure is approximately -4.471376 mmHg, suggesting that, on average, individuals with a BMI greater than 25 experienced a decrease of about 4.47 mmHg in systolic BP following the intervention.</p>
<p>The results of the paired t-test indicate that the intervention was effective, resulting in a statistically significant decrease in systolic blood pressure among individuals with a BMI greater than 25. The average decrease of 4.47 mmHg is both statistically significant and clinically relevant.</p>
</section>
</div>
</section>
</section>
<section id="hypothesis-testing-and-interval-estimation-for-a-proportion" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="hypothesis-testing-and-interval-estimation-for-a-proportion"><span class="header-section-number">6.5.3</span> Hypothesis Testing and Interval Estimation for a Proportion</h3>
<p>Now we cover the concepts of hypothesis testing and interval estimation for proportions.</p>
<section id="hypothesis-testing-for-a-proportion" class="level4" data-number="6.5.3.1">
<h4 data-number="6.5.3.1" class="anchored" data-anchor-id="hypothesis-testing-for-a-proportion"><span class="header-section-number">6.5.3.1</span> Hypothesis Testing for a Proportion</h4>
<p>Our research question is:</p>
<p><em>Is the prevalence of diabetes in the adult population equal to 10%?</em></p>
<p><strong>Hypotheses:</strong></p>
<p><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): The proportion of individuals with diabetes in the adult population is equal to 20% (i.e., <span class="math inline">\(p = 0.10\)</span>).</p>
<p><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_1\)</span>): The proportion of individuals with diabetes in the adult population is not equal to 20% (i.e., <span class="math inline">\(p \neq 0.10\)</span>).</p>
<p><strong>Conducting the Test in R</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>diabetes_count <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(diabetes) <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diabetes <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>total_count <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(diabetes) <span class="sc">|&gt;</span>  </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(diabetes_count, total_count, <span class="at">p =</span> <span class="fl">0.10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  diabetes_count out of total_count, null probability 0.1
X-squared = 0.028762, df = 1, p-value = 0.8653
alternative hypothesis: true p is not equal to 0.1
95 percent confidence interval:
 0.09270515 0.10639994
sample estimates:
         p 
0.09934483 </code></pre>
</div>
</div>
<p>Interpretation of Results</p>
<p>With a p-value of 0.8653, which is much greater than the standard significance level of 0.05, we fail to reject the null hypothesis. This indicates that there is not enough evidence to suggest that the proportion of individuals with diabetes in the population differs from 10%.</p>
<p>In a clinical context, this suggests that the observed prevalence of diabetes in the sample is consistent with the expected prevalence, and no significant deviation is noted.</p>
</section>
<section id="confidence-interval-for-a-proportion" class="level4" data-number="6.5.3.2">
<h4 data-number="6.5.3.2" class="anchored" data-anchor-id="confidence-interval-for-a-proportion"><span class="header-section-number">6.5.3.2</span> Confidence Interval for a Proportion</h4>
<p><strong>Interpretation of Confidence Interval</strong></p>
<p>From the above result, we have the 95% confidence interval for the proportion of individuals with diabetes is approximately (0.0927,0.1064). This interval suggests that we can be 95% confident that the true proportion of individuals with diabetes in the population lies between 9.27% and 10.64%.</p>
<p>This finding supports the conclusion from the hypothesis test that the proportion is consistent with the specified null value of 10%, providing further assurance that the prevalence of diabetes in the population is stable and aligns with previous estimates.</p>
</section>
</section>
<section id="chi-squared-test" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4" class="anchored" data-anchor-id="chi-squared-test"><span class="header-section-number">6.5.4</span> Chi-Squared Test</h3>
<div style="text-align:justify">
<p>The chi-squared test is a statistical method used to determine if there is a significant association between two categorical variables. By comparing the observed frequency distribution of categories with the expected distribution (assuming no association), the test evaluates whether the variables are independent of each other or if there is an association. This test is particularly useful in analyzing relationships in large datasets with categorical data, like survey responses or patient characteristics.</p>
<p>As an example, we’ll use the chi-squared test to examine whether there is an association between BMI category and diabetes status among adults in our dataset.</p>
<p><strong>Hypotheses:</strong></p>
<p><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): There is no association between BMI category and diabetes status (BMI and diabetes status are independent).</p>
<p><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_1\)</span>): There is an association between BMI category and diabetes status.</p>
<p><strong>Data Preparation</strong></p>
<p>Ensure that the bmi_who and diabetes variables are factors:</p>
<p>If not then make it factor variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df<span class="sc">$</span>bmi_who)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df<span class="sc">$</span>diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
<p>Both variables are factor.</p>
<p><strong>Creating a Contingency Table in Tidy Format</strong></p>
<p>To perform a chi-squared test, we first need a contingency table that shows the counts of individuals in each combination of bmi_who and diabetes categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table in tidy format</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>bmi_who, df<span class="sc">$</span>diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Performing the Chi-Squared Test</strong></p>
<p>To assess whether an association exists between BMI category and diabetes, we apply the chi-squared test as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct the chi-squared test</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the test results</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>chi_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  contingency_table
X-squared = 206.12, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretation of Chi-Squared Test Results</strong></p>
<ul>
<li><p>Chi-Squared Statistic (X-squared): 206.12</p></li>
<li><p>Degrees of Freedom (df): 3</p></li>
<li><p>p-value: &lt; 2.2e-16</p></li>
</ul>
<p>Since the p-value is extremely small (less than 0.05), we reject the null hypothesis, indicating that there is a statistically significant association between BMI category and diabetes status. This suggests that diabetes prevalence differs across BMI categories in our sample.</p>
<p>However, while statistical significance tells us there is an association, it does not reveal the direction or strength of the relationship. To determine the strength and direction—such as whether higher BMI categories are positively associated with increased diabetes risk—you could perform a regression analysis.</p>
<p>For binary outcomes like diabetes status, logistic regression would be a suitable approach. It would allow us to model the probability of diabetes as a function of BMI categories while providing insights into how each category impacts the likelihood of diabetes, as reflected by odds ratios. This approach also enables adjustments for potential confounders, offering a more comprehensive understanding of the relationship.</p>
</div>
</section>
<section id="one-way-anova" class="level3" data-number="6.5.5">
<h3 data-number="6.5.5" class="anchored" data-anchor-id="one-way-anova"><span class="header-section-number">6.5.5</span> One-way ANOVA</h3>
<div style="text-align:justify">
<p>One-way ANOVA (Analysis of Variance) is used to compare the means of more than two groups to determine if at least one group mean differs significantly from the others. This method is suitable when we have a categorical independent variable (factor) with multiple levels and a continuous dependent variable. For example, we could use one-way ANOVA to test if the average blood pressure differs across BMI categories.</p>
<p>As an example, we’ll use the one-way ANOVA To determine if average systolic blood pressure varies across BMI categories.</p>
<p><strong>Hypotheses:</strong></p>
<p><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): The average systolic blood pressure is the same across all BMI categories.</p>
<p><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_1\)</span>): The average systolic blood pressure differs for at least one BMI category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the ANOVA model</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(bp_sys_ave <span class="sc">~</span> bmi_who, <span class="at">data =</span> df)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df  Sum Sq Mean Sq F value Pr(&gt;F)    
bmi_who        3   42791   14264   50.35 &lt;2e-16 ***
Residuals   7116 2015921     283                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
361 observations deleted due to missingness</code></pre>
</div>
</div>
<p><strong>Interpretation of One-Way ANOVA Results</strong></p>
<ul>
<li><p><strong>Degrees of Freedom (Df)</strong>: The degrees of freedom for the BMI categories is 3, meaning there are four BMI groups. The residual degrees of freedom is 7116, accounting for the total sample size minus the number of groups.</p></li>
<li><p><strong>Sum of Squares (Sum Sq)</strong>: This indicates the variability within each group (Residuals) and between the groups (BMI categories). A larger Sum of Squares for the BMI groups relative to the residuals suggests substantial variation in systolic blood pressure due to BMI category.</p></li>
<li><p><strong>Mean Squares (Mean Sq)</strong>: This is the Sum of Squares divided by the respective degrees of freedom. The larger Mean Square for BMI groups indicates a larger variability attributed to BMI categories compared to random error.</p></li>
<li><p><strong>F-value</strong>: The F-value of 50.35 is substantial, suggesting that the variation in systolic blood pressure between the BMI categories is much greater than within each category.</p></li>
<li><p><strong>p-value (&lt; 2e-16)</strong>: The extremely small p-value is well below 0.05, leading us to reject the null hypothesis. This indicates that there is a statistically significant difference in systolic blood pressure among the different BMI categories in this sample.</p></li>
</ul>
<p>Since the ANOVA indicates a significant difference, a post-hoc analysis (such as Tukey’s HSD) could be conducted to identify which BMI categories specifically differ from each other in terms of average systolic blood pressure.</p>
</div>
</section>
</section>
<section id="inferential-statistics-regression-analysis" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="inferential-statistics-regression-analysis"><span class="header-section-number">6.6</span> Inferential Statistics: Regression Analysis</h2>
<div style="text-align:justify">
<p>Regression analysis is a powerful statistical method used to examine the relationship between two or more variables. The goal of regression is to understand how the dependent variable (also called the outcome or response variable) changes when one or more independent variables (also known as predictors or explanatory variables) are varied This method is widely used in various fields such as economics, healthcare, social sciences, and engineering to make predictions, identify trends, and uncover relationships between variables.</p>
<p>There are various types of regression, each suited to different types of data and research questions. Some common types include:</p>
<ul>
<li><p><strong>Linear Regression:</strong> This examines the relationship between one independent variable and one or more dependent variables, assuming a linear relationship between them.</p></li>
<li><p><strong>Logistic Regression:</strong> Used when the dependent variable is categorical, typically binary (e.g., success/failure). It models the probability of the outcome occurring.</p></li>
<li><p><strong>Generalized Linear Models (GLM):</strong> These extend linear regression to handle various types of dependent variables, including count data and proportions, using different link functions. Both linear regression and logistic regression are actually special cases of GLMs. Linear regression uses an identity link function for continuous outcomes, while logistic regression uses a logit link function for binary outcomes. This flexibility makes GLMs a versatile tool for modeling a wide range of data types.</p></li>
<li><p><strong>Generalized Mixed Models (GLMM):</strong> A more advanced approach that handles both fixed and random effects, useful for dealing with hierarchical or clustered data, and when the data structure involves more complex relationships.</p></li>
</ul>
<p>In this session, we will focus on two important types of regression: linear regression and logistic regression, and demonstrate how to perform them in R.</p>
</div>
<section id="simple-linear-regression" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="simple-linear-regression"><span class="header-section-number">6.6.1</span> Simple Linear Regression</h3>
<div style="text-align:justify">
<p>Simple Linear regression (SLR) is one of the most widely used statistical methods for modeling the relationship between a dependent variable and one independent variable. However, to ensure the model’s accuracy and validity, several assumptions must be met.</p>
</div>
<section id="assumptions-of-simple-linear-regression" class="level4" data-number="6.6.1.1">
<h4 data-number="6.6.1.1" class="anchored" data-anchor-id="assumptions-of-simple-linear-regression"><span class="header-section-number">6.6.1.1</span> Assumptions of Simple Linear Regression</h4>
<div style="text-align:justify">
<p>The acronym <strong>LINE</strong> helps us remember the key assumptions needed for making inferences and predictions with models based on linear least squares regression (LLSR).</p>
<p>In the case of simple linear regression with a single predictor <span class="math inline">\(X\)</span>, the assumptions are as follows:</p>
<ul>
<li><p><strong>L (Linear relationship)</strong>: The mean of the response variable <span class="math inline">\(Y\)</span> is linearly related to the predictor variable <span class="math inline">\(X\)</span>.</p></li>
<li><p><strong>I (Independence of errors)</strong>: The errors (or residuals) are independent, meaning that the distance between any two points from the regression line is unrelated.</p></li>
<li><p><strong>N (Normal distribution)</strong>: For each value of <span class="math inline">\(X\)</span>, the response <span class="math inline">\(Y\)</span> is normally distributed.</p></li>
<li><p><strong>E (Equal variance)</strong>: The variance (or standard deviation) of the responses is constant for all values of <span class="math inline">\(X\)</span>.</p></li>
</ul>
<p>These assumptions can be illustrated visually:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/linear_regression.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Assumptions for linear least squares regression (LLSR) <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-MLRreview.html#assumptions-for-linear-least-squares-regression">(Roback and Legler, 2021)</a></figcaption><p></p>
</figure>
</div>
<ul>
<li><p>L: The expected value of <span class="math inline">\(Y\)</span> at each <span class="math inline">\(X\)</span> lies along the regression line.</p></li>
<li><p>I: We should verify that the design of the study ensures the errors are independent.</p></li>
<li><p>N: The values of <span class="math inline">\(Y\)</span> are normally distributed at each level of <span class="math inline">\(X\)</span>.</p></li>
<li><p>E: The spread of <span class="math inline">\(Y\)</span> is consistent across all levels of <span class="math inline">\(X\)</span>.</p></li>
</ul>
</div>
</section>
<section id="the-simple-linear-regression-model" class="level4" data-number="6.6.1.2">
<h4 data-number="6.6.1.2" class="anchored" data-anchor-id="the-simple-linear-regression-model"><span class="header-section-number">6.6.1.2</span> The Simple Linear Regression Model</h4>
<div style="text-align:justify">
<p>In SLR, the goal is to model the relationship between a dependent variable (response) and an independent variable (predictor). The model predicts the dependent variable based on the independent variable, helping us understand how changes in one variable impact the other.</p>
<p>The general form of a simple linear regression model is:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X + \epsilon\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> is the dependent variable (the outcome we are predicting).</p></li>
<li><p><span class="math inline">\(X\)</span> is the independent variable (the predictor).</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the intercept (the expected value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X=0\)</span>).</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> is the slope (the change in <span class="math inline">\(Y\)</span> for each unit increase in <span class="math inline">\(X\)</span>).</p></li>
<li><p><span class="math inline">\(\epsilon\)</span> is the error term, representing the variability in <span class="math inline">\(Y\)</span> not explained by <span class="math inline">\(X\)</span>.</p></li>
</ul>
</div>
</section>
<section id="interpreting-the-model" class="level4" data-number="6.6.1.3">
<h4 data-number="6.6.1.3" class="anchored" data-anchor-id="interpreting-the-model"><span class="header-section-number">6.6.1.3</span> Interpreting the Model</h4>
<div style="text-align:justify">
<ul>
<li><p><strong>Intercept (</strong><span class="math inline">\(\beta_0\)</span>): The intercept tells us the expected value of the dependent variable when the independent variable is zero. However, in some cases, like the relationship between height and weight, interpreting the intercept might not make practical sense (e.g., predicting weight when height is zero).</p></li>
<li><p><strong>Slope (</strong><span class="math inline">\(\beta_1\)</span>): The slope indicates the change in the dependent variable for a one-unit change in the independent variable. For example, if we are looking at the relationship between height and weight, the slope tells us how much weight is expected to increase (or decrease) for every unit increase in height.</p></li>
<li><p><strong>Error term (</strong><span class="math inline">\(\epsilon\)</span>): The error term captures the variation in the dependent variable that is not explained by the independent variable. In practice, our model won’t perfectly predict every observation, and this error term accounts for the difference between observed values and the values predicted by the model.</p></li>
</ul>
</div>
</section>
</section>
<section id="simple-linear-regression-using-r" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="simple-linear-regression-using-r"><span class="header-section-number">6.6.2</span> Simple Linear Regression Using R</h3>
<div style="text-align:justify">
<p>If the assumptions of simple linear regression are met, we can proceed with fitting the model to the data. In this section, we will explore how to perform simple linear regression using R. This method allows us to examine the relationship between a dependent variable (response) and an independent variable (predictor) and make predictions based on the data.</p>
</div>
<section id="simple-linear-regression-with-a-numeric-independent-variable" class="level4" data-number="6.6.2.1">
<h4 data-number="6.6.2.1" class="anchored" data-anchor-id="simple-linear-regression-with-a-numeric-independent-variable"><span class="header-section-number">6.6.2.1</span> Simple Linear Regression with a Numeric Independent Variable</h4>
<div style="text-align:justify">
<p>When dealing with a numeric independent variable, simple linear regression helps us understand how changes in the independent variable affect the dependent variable. In R, we can easily fit and evaluate this relationship using the lm() function.</p>
<p>Here’s an example of performing simple linear regression when the independent variable is numeric:</p>
<p><strong>Research Question</strong></p>
<p>Using the NHANES dataset, our research question is:</p>
<p>In adults, is there a relationship between height (independent variable) and weight (dependent variable)?</p>
</div>
<p><strong>Data Wrangling</strong></p>
<div style="text-align:justify">
<p>Before we perform the Simple Linear Regression, we need to load and clean the NHANES dataset.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instal and load packages</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(pacman)</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, broom)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Data</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> NHANES<span class="sc">::</span>NHANES</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">&gt;=</span> <span class="dv">18</span>)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Set "White" as the reference category directly using factor()</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race1 =</span> <span class="fu">factor</span>(Race1, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Black"</span>, <span class="st">"Mexican"</span>, <span class="st">"Hispanic"</span>, <span class="st">"Other"</span>)))</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean names</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">race =</span> race1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>SLR Model</strong></p>
<div style="text-align:justify">
<p>Now, we build the linear regression model to examine the relationship between height and weight in adults.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> df)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ height, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.329 -13.299  -2.887   9.673 149.022 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -78.06686    3.69698  -21.12   &lt;2e-16 ***
height        0.94804    0.02186   43.38   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.01 on 7412 degrees of freedom
  (67 observations deleted due to missingness)
Multiple R-squared:  0.2025,    Adjusted R-squared:  0.2024 
F-statistic:  1882 on 1 and 7412 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  -78.1      3.70       -21.1 3.66e-96
2 height         0.948    0.0219      43.4 0       </code></pre>
</div>
</div>
<div style="text-align:justify">
<ul>
<li><p>The <code>lm()</code> function fits a simple linear regression model, and <code>summary()</code> provides detailed results including the regression coefficients, <span class="math inline">\(R^2\)</span>, and p-values.</p></li>
<li><p>The <code>tidy()</code> function from the <code>broom</code> package organizes the model output in a tidy format.</p></li>
</ul>
</div>
<p><strong>SLR Model Interpretation</strong></p>
<div style="text-align:justify">
<p>The Simple Linear Regression (SLR) model fits the relationship between height and weight in the adult population from the NHANES dataset. Below is a breakdown of the model output:</p>
<p><strong>Model Equation</strong></p>
<p>The general form is</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X\]</span></p>
<p>The model equation based on the output can be written as:</p>
<p><span class="math display">\[\text{Weight} = -78.07 + 0.95 \times \text{Height}\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(\hat{y}\)</span> is the predicted weight (in kg)</p></li>
<li><p>The intercept (-78.07) represents the predicted weight when height is zero, which doesn’t have a practical interpretation in this context but is mathematically part of the model.</p></li>
<li><p>The slope (0.95) indicates that for each additional unit of height (in cm), the weight is expected to increase by approximately 0.95 kg, on average.</p></li>
</ul>
<p><strong>Coefficients</strong></p>
<ul>
<li><p>Intercept (-78.07): The negative intercept is not practically meaningful since height cannot be zero in adults, but it is part of the linear equation.</p></li>
<li><p>Height (0.95): The slope suggests that for every additional centimeter in height, weight increases by about 0.95 kg on average. The very small p-value (<span class="math inline">\(&lt;2e^-16\)</span>) indicates that the effect of height on weight is highly statistically significant.</p></li>
</ul>
<p><strong>Residuals</strong></p>
<p>The residuals show the differences between the observed and predicted values of weight:</p>
<ul>
<li><p>The minimum residual is -41.33, and the maximum is 149.02, indicating some large deviations.</p></li>
<li><p>The median residual is -2.89, suggesting that most predictions are close to the observed values.</p></li>
</ul>
<p><strong>Goodness of Fit</strong></p>
<p><strong>R-squared (0.2025)</strong> Approximately 20.25% of the variance in weight is explained by height, which suggests that while height has a significant impact on weight, other factors also influence weight substantially.</p>
<p><strong>Adjusted R-squared (0.2024)</strong> Very close to the R-squared, confirming the model is reliable for this data.</p>
<p><strong>Model Significance</strong></p>
<p>The F-statistic (1882) and its corresponding p-value (&lt;2.2e−16) indicate that the model is highly significant, meaning height is a useful predictor for weight in this dataset.</p>
<p>The interpretation shows that height has a positive and significant relationship with weight, but the relatively low <span class="math inline">\(R^2\)</span> value suggests that other factors besides height influence weight.</p>
</div>
</section>
<section id="simple-linear-regression-with-a-categorical-independent-variable" class="level4" data-number="6.6.2.2">
<h4 data-number="6.6.2.2" class="anchored" data-anchor-id="simple-linear-regression-with-a-categorical-independent-variable"><span class="header-section-number">6.6.2.2</span> Simple Linear Regression with a Categorical Independent Variable</h4>
<p>When dealing with a categorical independent variable, simple linear regression can be used to analyze how the different categories influence the dependent variable. In this case, we’ll explore the relationship between height and race in adults using the NHANES dataset.</p>
<p><strong>Research Question</strong></p>
<p>Is there an association between race and weight in adult individuals from the NHANES dataset?</p>
<p><strong>SLR Model</strong></p>
<p>In this analysis, we treat race as a categorical variable and examine its relationship with weight The regression equation for a categorical independent variable will include dummy coding (where one category is taken as the reference).</p>
<p>Here’s how you can perform the simple linear regression with a categorical variable in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SLR Model with Categorical Independent Variable</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>model_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> race, <span class="at">data =</span> df)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ race, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.787 -15.028  -2.828  11.872 142.813 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   82.5284     0.2992 275.794  &lt; 2e-16 ***
raceBlack      5.3582     0.7803   6.867 7.11e-12 ***
raceMexican   -1.9117     0.8863  -2.157    0.031 *  
raceHispanic  -4.2676     1.0616  -4.020 5.88e-05 ***
raceOther     -9.4982     0.9286 -10.229  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.02 on 7415 degrees of freedom
  (61 observations deleted due to missingness)
Multiple R-squared:  0.02501,   Adjusted R-squared:  0.02448 
F-statistic: 47.55 on 4 and 7415 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidying the output for better interpretation</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     82.5      0.299    276.   0       
2 raceBlack        5.36     0.780      6.87 7.11e-12
3 raceMexican     -1.91     0.886     -2.16 3.10e- 2
4 raceHispanic    -4.27     1.06      -4.02 5.88e- 5
5 raceOther       -9.50     0.929    -10.2  2.14e-24</code></pre>
</div>
</div>
<p><strong>SLR Model Interpretation</strong></p>
<div style="text-align:justify">
<p>The Simple Linear Regression (SLR) model fits the relationship between race and weight in the adult population from the NHANES dataset. Below is a breakdown of the model output:</p>
<p><strong>Model Equation</strong></p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \text{(Group1)} + \beta_2 \text{(Group2)} + \dots +
\\ \beta_k \text{(Group\(k\))}\]</span></p>
<p>The model equation based on the output can be written as:</p>
<p><span class="math display">\[\hat{y} = 82.53 + 5.36 \times \text{(Black)} - 1.91 \times \text{(Mexican)} -
\\ 4.27 \times \text{(Hispanic)} - 9.50 \times \text{(Other)}\]</span></p>
<p><strong>Coefficients</strong></p>
<ul>
<li><p><strong>Intercept:</strong> The estimated average weight for individuals in the reference category (White) is 82.53 units.</p></li>
<li><p><code>raceBlack</code>: Black individuals have an average weight that is 5.36 units heavier than the reference category (White).</p></li>
<li><p><code>raceMexican</code>: Mexican individuals weigh, on average, 1.91 units less than the reference category (White).</p></li>
<li><p><code>raceHispanic</code>: Hispanic individuals have an average weight that is 4.27 units less than the reference category (White).</p></li>
<li><p><code>raceOther</code>: Individuals in the Other category weigh, on average, 9.50 units less than the reference category (White).</p></li>
</ul>
<p><strong>Residuals</strong></p>
<p>Residuals indicate the differences between observed and predicted weights. They range from a minimum of -48.79 to a maximum of 142.81, showing variability in model predictions.</p>
<p><strong>Goodness of Fit</strong></p>
<ul>
<li><p><strong>Residual standard error:</strong> 21.02, indicating the average distance between observed and predicted values.</p></li>
<li><p><strong>Multiple R-squared:</strong> 0.02501, meaning that approximately 2.5% of the variability in weight is explained by race.</p></li>
<li><p><strong>Adjusted R-squared:</strong> 0.02448, which adjusts for the number of predictors in the model.</p></li>
</ul>
</div>
</section>
</section>
<section id="multiple-linear-regression-using-r" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="multiple-linear-regression-using-r"><span class="header-section-number">6.6.3</span> Multiple Linear Regression using R</h3>
<div style="text-align:justify">
<p>Multiple linear regression expands on simple linear regression by incorporating multiple independent variables (predictors) to predict the outcome variable (dependent variable). This approach allows us to analyze how each predictor contributes to the outcome, while controlling for other variables.</p>
<p>The general form of a multiple linear regression model with k predictors,</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k + \epsilon\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span>: Dependent variable</p></li>
<li><p><span class="math inline">\(X_1, X_2,...,X_k\)</span>: Independent variables (predictors)</p></li>
<li><p>$ _0$: Intercept (the expected value of <span class="math inline">\(Y\)</span> when all <span class="math inline">\(X\)</span> variables are zero)</p></li>
<li><p><span class="math inline">\(, \beta_1, \beta_2, ..., \beta_k\)</span>: Coefficients for each independent variable, indicating the expected change in <span class="math inline">\(Y\)</span> for a one-unit change in that variable, holding other variables constant.</p></li>
<li><p><span class="math inline">\(\epsilon\)</span>: Error term (the difference between the observed and predicted values)</p></li>
</ul>
<p><strong>Research Question</strong></p>
<p>Is there an association between height and race (independent variables) with weight in adult individuals from the NHANES dataset?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple linear regression model </span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>model_mult <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> race, <span class="at">data =</span> df)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ height + race, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.112 -12.997  -3.001   9.428 143.315 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -78.3458     3.7685 -20.790  &lt; 2e-16 ***
height         0.9460     0.0221  42.800  &lt; 2e-16 ***
raceBlack      6.3330     0.6993   9.056  &lt; 2e-16 ***
raceMexican    2.8470     0.8017   3.551 0.000386 ***
raceHispanic   1.2325     0.9591   1.285 0.198808    
raceOther     -5.3690     0.8375  -6.410 1.54e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.82 on 7408 degrees of freedom
  (67 observations deleted due to missingness)
Multiple R-squared:  0.2184,    Adjusted R-squared:  0.2179 
F-statistic:   414 on 5 and 7408 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidying the output for better interpretation</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -78.3      3.77      -20.8  2.39e-93
2 height          0.946    0.0221     42.8  0       
3 raceBlack       6.33     0.699       9.06 1.70e-19
4 raceMexican     2.85     0.802       3.55 3.86e- 4
5 raceHispanic    1.23     0.959       1.29 1.99e- 1
6 raceOther      -5.37     0.838      -6.41 1.54e-10</code></pre>
</div>
</div>
<p><strong>Model</strong></p>
<p><span class="math display">\[\text{Weight} = -78.35 + 0.946 \times \text{Height} + 6.333 \times \text{raceBlack}\]</span> <span class="math display">\[2.847 \times \text{raceMexican} + 1.233 \times \text{raceHispanic} - \]</span> <span class="math display">\[5.369 \times \text{raceOther}\]</span></p>
<p>Let’s analyze the case of an individual with certain characteristics (height and race)</p>
<ul>
<li><p>For a Black Individual:</p></li>
<li><p>Height: 175 cm</p></li>
</ul>
<p>Race: Black (which is coded as 1 in the model, while other races are coded as 0)</p>
<p><span class="math display">\[Weight = − 78.35 + 0.946 × 175 + 6.333 × 1 + 2.847 × 0 + 1.233 × 0 − 5.369 × 0\]</span> <span class="math display">\[Weight = − 78.35 + 165.55 + 6.333 = 93.533 kg\]</span></p>
<p>Therefore, the estimated average weight for a Black individual who is 175 cm tall is approximately 93.53 kg.</p>
<p>For a White Individual:</p>
<p>Height: 175 cm Race: White (which is coded as 0 in the model) Plugging these values into the model:</p>
<p><span class="math display">\[Weight = − 78.35 + 165.55 = 87.20 kg\]</span></p>
<p>Therefore, the estimated average weight for a White individual who is 175 cm tall is approximately 87.20 kg.</p>
<p>In addition, we observe that the coefficient for the Hispanic category is not statistically significant (p = 0.199), suggesting that, for this model, being Hispanic does not have a statistically significant impact on weight compared to the reference category (White) when controlling for height. This lack of significance indicates that the model does not provide evidence of a meaningful difference in weight between White and Hispanic individuals at the same height within this dataset.</p>
</div>
</section>
<section id="logistic-regression-using-r" class="level3" data-number="6.6.4">
<h3 data-number="6.6.4" class="anchored" data-anchor-id="logistic-regression-using-r"><span class="header-section-number">6.6.4</span> Logistic Regression using R</h3>
<div style="text-align:justify">
<p>In this book, we’re providing a basic introduction to performing logistic regression using R, without diving deeply into the underlying concepts. For readers interested in a more detailed exploration of logistic regression, please refer to <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC8710907/pdf/fmch-2021-001290.pdf">(Harris, 2021)</a>.</p>
<p>In the following example, we aim to address the following research question:</p>
<p>“Is there an association between age, BMI category, and the likelihood of diabetes in the adult population from the dataset?”</p>
<p>This logistic regression model will help determine if age and BMI classification (underweight, normal weight, overweight, and obesity) are significant predictors of diabetes status, providing insights into factors contributing to diabetes risk in the study population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>model_logistic <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> age <span class="sc">+</span> bmi_who, <span class="at">data =</span> df,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get the summary of the model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_logistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = diabetes ~ age + bmi_who, family = "binomial", 
    data = df)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         -6.662789   0.616689 -10.804  &lt; 2e-16 ***
age                  0.056303   0.002673  21.061  &lt; 2e-16 ***
bmi_who18.5_to_24.9  0.678591   0.604095   1.123 0.261303    
bmi_who25.0_to_29.9  1.187684   0.599514   1.981 0.047582 *  
bmi_who30.0_plus     2.089203   0.597437   3.497 0.000471 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4754.5  on 7381  degrees of freedom
Residual deviance: 4023.6  on 7377  degrees of freedom
  (99 observations deleted due to missingness)
AIC: 4033.6

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p><strong>The Model Equation</strong></p>
<p>The logistic regression model equation for predicting the log-odds of diabetes is:</p>
<p><span class="math display">\[\log\left(\frac{1 - P(\text{diabetes})}{P(\text{diabetes})}\right) = -6.66 + 0.056 \times \text{age} + 0.679 \times \text{BMI}_{18.5-24.9} + \]</span> <span class="math display">\[1.188 \times \text{BMI}_{25.0-29.9} + 2.089 \times \text{BMI}_{30.0+}\]</span></p>
<p><strong>Interpretation</strong></p>
<p>For a more intuitive interpretation, we can exponentiate the coefficients to convert them from log-odds to odds ratios, making it easier to discuss the association between each predictor and the likelihood of diabetes.</p>
<p>Code for Odds Ratio Conversion To compute the odds ratios along with confidence intervals for each coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model_logistic)) <span class="co"># odds ratio</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>or_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model_logistic)) <span class="co"># Confidence Interval of odd ratio</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">OR =</span> OR,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI =</span> or_ci</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">|&gt;</span> </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Variable"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  Variable                 OR CI.2.5.. CI.97.5..
  &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)         0.00128 0.000301   0.00367
2 age                 1.06    1.05       1.06   
3 bmi_who18.5_to_24.9 1.97    0.707      8.21   
4 bmi_who25.0_to_29.9 3.28    1.19      13.6    
5 bmi_who30.0_plus    8.08    2.95      33.4    </code></pre>
</div>
</div>
<p>Here’s a summary of the interpretation based on the odds ratios (OR) and confidence intervals:</p>
<ul>
<li><p><strong>Intercept</strong>: The intercept represents the baseline odds of having diabetes when all predictors are at their reference levels (age = 0 and BMI &lt;18.5). The odds are very low at 0.00128, indicating a low baseline risk in the reference group.</p></li>
<li><p><strong>Age</strong>: With an odds ratio of 1.06 (95% CI: 1.05 to 1.06), each additional year of age is associated with a 6% increase in the odds of having diabetes, assuming all other factors remain constant. The confidence interval is narrow and above 1, suggesting a statistically significant effect of age on diabetes risk.</p></li>
<li><p><strong>BMI Category (18.5–24.9)</strong>: This group has an odds ratio of 1.97 (95% CI: 0.707 to 8.21) compared to the reference category (presumably BMI &lt; 18.5). The CI is wide and includes 1, suggesting that this effect is not statistically significant at conventional levels. This indicates that adults in the BMI 18.5–24.9 category may have an increased risk, but this finding is uncertain.</p></li>
<li><p><strong>BMI Category (25.0–29.9)</strong>: The odds ratio for this category is 3.28 (95% CI: 1.19 to 13.6), indicating that individuals in this BMI range have approximately 3.28 times the odds of having diabetes compared to the reference group. The confidence interval does not include 1, suggesting this result is statistically significant.</p></li>
<li><p><strong>BMI Category (30.0+)</strong>: With an odds ratio of 8.08 (95% CI: 2.95 to 33.4), individuals with a BMI over 30 have over 8 times the odds of having diabetes compared to the reference group. The confidence interval is well above 1, indicating a strong and statistically significant association between a high BMI and increased diabetes risk.</p></li>
</ul>
</div>
</section>
<section id="summary" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="summary">Summary</h3>
<div style="text-align:justify">
<p>To be updated</p>
</div>
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-banerjee2009" class="csl-entry" role="doc-biblioentry">
Banerjee, Amitav, Ub Chitnis, Sl Jadhav, Js Bhawalkar, and S Chaudhury. 2009. <span>“Hypothesis Testing, Type I and Type II Errors.”</span> <em>Industrial Psychiatry Journal</em> 18 (2): 127. <a href="https://doi.org/10.4103/0972-6748.62274">https://doi.org/10.4103/0972-6748.62274</a>.
</div>
<div id="ref-hazra2017" class="csl-entry" role="doc-biblioentry">
Hazra, Avijit. 2017. <span>“Using the Confidence Interval Confidently.”</span> <em>Journal of Thoracic Disease</em> 9 (10): 4124–29. <a href="https://doi.org/10.21037/jtd.2017.09.14">https://doi.org/10.21037/jtd.2017.09.14</a>.
</div>
<div id="ref-walker2019" class="csl-entry" role="doc-biblioentry">
Walker, J. 2019. <span>“Hypothesis Tests.”</span> <em>BJA Education</em> 19 (7): 227–31. <a href="https://doi.org/10.1016/j.bjae.2019.03.006">https://doi.org/10.1016/j.bjae.2019.03.006</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro_r.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to R and RStudio</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>